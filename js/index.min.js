"use strict";var status="JS - OK!";function cl(e,t,n,o){return console.log(e,t||"",n||"",o||""),"-"}var glob={navMenuWrapper:null,navMenu:null,pageOverlay:null,scrollTopButton:null},globFunc={returnDOM:function(e){return e instanceof jQuery?e[0]:e},showOverlay:function(e,t,n){switch(e){case"popup":t.classList.contains("js_openPopup")||(t.style.zIndex=1150,t.style.visibility="visible",t.classList.add("js_openPopup"),t.classList.add("js_open"),n&&t.classList.add(n),document.body.classList.add("js_pageOverlayOpen"));break;case"menu":t.classList.contains("js_openMenu")||(t.style.zIndex=900,t.style.visibility="visible",t.classList.add("js_openMenu"),t.classList.add("js_open"),document.body.classList.add("js_pageOverlayOpen"))}},hideOverlay:function(e,t,n){switch(e){case"popup":t.classList.contains("js_openPopup")&&(t.classList.remove("js_openPopup"),t.classList.remove("js_open"),n&&t.classList.remove(n),document.body.classList.remove("js_pageOverlayOpen"),setTimeout(function(){t.classList.contains("js_openPopup")||(t.style.zIndex=-10,t.style.visibility="hidden")},300));break;case"menu":t.classList.contains("js_openMenu")&&(t.classList.remove("js_openMenu"),t.classList.remove("js_open"),document.body.classList.remove("js_pageOverlayOpen"),setTimeout(function(){t.classList.contains("js_openMenu")||(t.style.zIndex=-10,t.style.visibility="hidden")},300))}},toggleButtonContent:function(e,t){var n,o=this.returnDOM(e);t?n=t:e.dataset.text&&(n={default:e.dataset.text,active:e.dataset.textActive}),o.classList.contains("active")?(n&&(o.querySelector("span").innerHTML=n.default),o.classList.remove("active")):(n&&(o.querySelector("span").innerHTML=n.active),o.classList.add("active"))},dropDown:function(e,t){e.checked||e.classList.contains("active")?t.style.height=t.firstElementChild.offsetHeight+"px":t.style.height="0px"},animateBlock:function(e){var t=this;this.removeClassFrom(e,"js_animate"),setTimeout(function(){t.addClassTo(e,"js_animate")},50)},getCurrentYPosition:function(){return window.pageYOffset||document.documentElement.scrollTop},addClassTo:function(e,t){var n=this.returnDOM(e);n.classList.contains(t)||n.classList.add(t)},removeClassFrom:function(e,t){var n=this.returnDOM(e);n.classList.contains(t)&&n.classList.remove(t)},transitionHandler:function(e,t,n){e.propertyName&&console.log(e.propertyName),e.srcElement&&console.log(e.srcElement)},getChildsTotalWidth:function(e){for(var t=e.children,n=0,o=0;o<t.length;o++)n+=t[o].offsetWidth;return n},getCoordsOnPage:function(e){var t=this.returnDOM(e).getBoundingClientRect();return{top:t.top+pageYOffset,left:t.left+pageXOffset,bottom:t.bottom+pageYOffset}},getCoordsOnScreen:function(e){var t=this.returnDOM(e).getBoundingClientRect();return{top:t.top,left:t.left,bottom:t.bottom,right:t.right,width:t.width,height:t.height}},openWidth:function(e){e.style.width=getChildsTotalWidth(e)+"px"},collapseWidth:function(e){e.style.width="0"},isVisible:function(e,t){var n=void 0;n=t||"whole";var o=window.pageYOffset,s=document.documentElement.clientHeight,i=e.getBoundingClientRect().top+pageYOffset,l=i+e.offsetHeight;return"whole"==n?document.documentElement.clientWidth>991?l<=o+s&&i>=o:i<=o+s/2&&i>=o:"topBorder"==n?i>=o+130&&i<=o+s:"topBorderIn"==n?i<=o+s:void 0},isVisibleOnXAxis:function(e,t){var n=e.getBoundingClientRect().left>t.getBoundingClientRect().left,o=e.getBoundingClientRect().right<t.getBoundingClientRect().right;return n&&o},isLastChild:function(e){return!e.nextElementSibling},isFirstChild:function(e){return!e.previousElementSibling}},test="include js error";$(document).ready(function(){console.log("document ready"),test="include js - OK",glob.navMenuWrapper=document.getElementById("navMenuWrapper"),glob.navMenu=document.getElementById("navMenu"),glob.pageOverlay=document.getElementById("pageOverlay"),$("body")||console.log("jQuery Error"),$(".dropdownButton").on("click",function(){globFunc.toggleButtonContent(this),globFunc.dropDown(this,glob.navMenuWrapper)}),$("body").on("click",".searchButton",function(){var e=$("#popupSearch");e.length&&glob.PopupModule.openPopup(e,"js_openPopup_search")}),$("body").on("click",".button",function(){var e=document.getElementById("id");e&&glob.PopupModule.openPopup(e)}),$(".description .ellipsis").dotdotdot({height:80,truncate:"word",watch:!0}),$(".title.ellipsis").dotdotdot({height:85,truncate:"word",watch:!0});var e=document.querySelectorAll(".description > p");if(e.length)for(var t=0;t<e.length;t++)!e[t].innerHTML&&e[t].parentElement.removeChild(e[t]);$(".slide").slick({dots:!0,infinite:!0,speed:500,fade:!0,cssEase:"linear",nextArrow:$(".next"),prevArrow:$(".prev")}),$(".slide").slick({nextArrow:'<button type="button" class="slick-next">prev</button>',prevArrow:'<button type="button" class="btn btn-primary">next</button>'}),$(".ert").slick({infinite:!0,slidesToShow:3,slidesToScroll:3})}),window.onload=function(){console.log("window load")};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInN0YXR1cyIsImNsIiwiYXJnMSIsImFyZzIiLCJhcmczIiwiYXJnNCIsImNvbnNvbGUiLCJnbG9iIiwibmF2TWVudVdyYXBwZXIiLCJuYXZNZW51IiwicGFnZU92ZXJsYXkiLCJnbG9iRnVuYyIsInJldHVybkRPTSIsImVsZW1lbnQiLCJqUXVlcnkiLCJzaG93T3ZlcmxheSIsIm92ZXJsYXlUeXBlIiwib3ZlcmxheUVsZW1lbnQiLCJhZGRpdGlvbmFsQ2xhc3MiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsInN0eWxlIiwiekluZGV4IiwidmlzaWJpbGl0eSIsImFkZCIsImRvY3VtZW50IiwiYm9keSIsImhpZGVPdmVybGF5IiwicmVtb3ZlIiwidG9nZ2xlQnV0dG9uQ29udGVudCIsImJ1dHRvbkVsZW1lbnQiLCJzdHJPYmoiLCJidXR0b24iLCJ0ZXh0IiwiZGF0YXNldCIsImFjdGl2ZSIsInRleHRBY3RpdmUiLCJidXR0b25BY3RpdmUiLCJkZWZhdWx0IiwiaW5uZXJIVE1MIiwiZHJvcERvd24iLCJ0YXJnZXRCbG9jayIsImNoZWNrZWQiLCJoZWlnaHQiLCJvZmZzZXRIZWlnaHQiLCJhbmltYXRlQmxvY2siLCJibG9jayIsInNlbGYiLCJ0aGlzIiwicmVtb3ZlQ2xhc3NGcm9tIiwic2V0VGltZW91dCIsImFkZENsYXNzVG8iLCJnZXRDdXJyZW50WVBvc2l0aW9uIiwid2luZG93IiwicGFnZVlPZmZzZXQiLCJkb2N1bWVudEVsZW1lbnQiLCJzY3JvbGxUb3AiLCJhY3RpdmVDbGFzcyIsImVsZW0iLCJ0cmFuc2l0aW9uSGFuZGxlciIsImV2ZW50IiwiaGlkZGVuQ29udGVudCIsInByb3BlcnR5TmFtZSIsInNyY0VsZW1lbnQiLCJsb2ciLCJnZXRDaGlsZHNUb3RhbFdpZHRoIiwicGFyZW50IiwiY2hpbGRyZW4iLCJyZXN1bHQiLCJpIiwibGVuZ3RoIiwib2Zmc2V0V2lkdGgiLCJnZXRDb29yZHNPblBhZ2UiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ0b3AiLCJib3giLCJsZWZ0IiwicGFnZVhPZmZzZXQiLCJnZXRDb29yZHNPblNjcmVlbiIsImJvdHRvbSIsInJpZ2h0Iiwib3BlbldpZHRoIiwid2lkdGgiLCJpc1Zpc2libGUiLCJvcHRpb24iLCJvcHQiLCJjbGllbnRIZWlnaHQiLCJ3aW5kb3dUb3AiLCJ3aW5kb3dIZWlnaHQiLCJlbGVtUGFnZUJvdHRvbSIsImNsaWVudFdpZHRoIiwiZWxlbVBhZ2VUb3AiLCJpc1Zpc2libGVPblhBeGlzIiwiaXNWaXNpYmxlT25MZWZ0IiwiaXNMYXN0Q2hpbGQiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJpc0ZpcnN0Q2hpbGQiLCJwcmV2aW91c0VsZW1lbnRTaWJsaW5nIiwidGVzdCIsIiQiLCJyZWFkeSIsImdldEVsZW1lbnRCeUlkIiwib24iLCJtb2RhbCIsIlBvcHVwTW9kdWxlIiwib3BlblBvcHVwIiwiZG90ZG90ZG90IiwidHJ1bmNhdGUiLCJ3YXRjaCIsInRleHRCbG9ja3MiLCJxdWVyeVNlbGVjdG9yQWxsIiwicGFyZW50RWxlbWVudCIsInJlbW92ZUNoaWxkIiwic2xpY2siLCJkb3RzIiwiaW5maW5pdGUiLCJzcGVlZCIsImZhZGUiLCJjc3NFYXNlIiwibmV4dEFycm93IiwicHJldkFycm93Iiwic2xpZGVzVG9TaG93Iiwic2xpZGVzVG9TY3JvbGwiLCJvbmxvYWQiXSwibWFwcGluZ3MiOiJhQUFBLElBQUlBLE9BQVMsV0FDYixTQUFTQyxHQUFHQyxFQUFNQyxFQUFNQyxFQUFNQyxHQUE5QixPQURBQyxRQUFJTixJQUFTRSxFQUFBQyxHQUFiLEdBQUFDLEdBQUEsR0FBQUMsR0FBQSxJQUNBLElBUUEsSUFBSUUsTUFDSEMsZUFBZ0IsS0FEakJDLFFBQUlGLEtBQ0hDLFlBQUFBLEtBRUFFLGdCQUhVLE1BUVhDLFVBQ0FDLFVBQUlELFNBQVdFLEdBQ2JELE9BQUFBLGFBQVdFLE9BQUFELEVBQWtCLEdBQUFBLEdBSTdCRSxZQUFhLFNBQVNDLEVBQWFDLEVBQWdCQyxHQUFuREgsT0FBQUEsR0FDRSxJQUFRQyxRQUNEQyxFQUFMRSxVQUFBQyxTQUFBLGtCQUNPSCxFQUFlRSxNQUFBQSxPQUFVQyxLQUM1QkgsRUFBQUksTUFBcUJDLFdBQXJCLFVBQ0FMLEVBQUFFLFVBQXFCSSxJQUFhLGdCQUNsQ04sRUFBZUUsVUFBY0ssSUFBQSxXQUc3Qk4sR0FBa0JELEVBQWVFLFVBQVVLLElBQUlOLEdBRS9DTyxTQUFTQyxLQUFLUCxVQUFVSyxJQUFJLHVCQUM3QixNQUdILElBQUssT0FBQVAsRUFBTEUsVUFBQUMsU0FBQSxpQkFDT0gsRUFBZUUsTUFBQUEsT0FBVUMsSUFDNUJILEVBQUFJLE1BQXFCQyxXQUFyQixVQUNBTCxFQUFBRSxVQUFxQkksSUFBYSxlQUNsQ04sRUFBZUUsVUFBY0ssSUFBQSxXQUM3QlAsU0FBQUEsS0FBZUUsVUFBY0ssSUFBQSx5QkF6QnhCRyxZQUFBLFNBQUFYLEVBQUFDLEVBQUFDLEdBK0JiUyxPQUFBQSxHQUNFLElBQVFYLFFBQ0RDLEVBQUxFLFVBQUFDLFNBQUEsa0JBQ01ILEVBQWVFLFVBQVVDLE9BQVMsZ0JBQ3BDSCxFQUFlRSxVQUFVUyxPQUFPLFdBR2hDVixHQUFrQkQsRUFBZUUsVUFBVVMsT0FBT1YsR0FFbERPLFNBQVNDLEtBQUtQLFVBQVVTLE9BQU8sc0JBQS9CSCxXQUFjTixXQUNIRixFQUFZRSxVQUFBQyxTQUFBLGtCQUNoQkgsRUFBZUUsTUFBZkcsUUFBa0MsR0FDckNMLEVBQXFCSyxNQUFyQkMsV0FBQSxXQUVELE1BRUosTUFHSCxJQUFLLE9BQUFOLEVBQUxFLFVBQUFDLFNBQUEsaUJBQ01ILEVBQWVFLFVBQVVDLE9BQVMsZUFDcENILEVBQWVFLFVBQVVTLE9BQU8sV0FDaENYLFNBQUFBLEtBQWVFLFVBQVVTLE9BQU8sc0JBQ2hDSCxXQUFjTixXQUNIRixFQUFZRSxVQUFBQyxTQUFBLGlCQUNoQkgsRUFBZUUsTUFBZkcsUUFBa0MsR0FDckNMLEVBQXFCSyxNQUFyQkMsV0FBQSxXQUVELFFBT1hNLG9CQUFxQixTQUFVQyxFQUFlQyxHQUE5Q0YsSUFDTUcsRUFETkgsRUFBQUEsS0FBcUJqQixVQUFBa0IsR0FNZkMsRUFBVUUsRUFBT0YsRUFBa0JELEVBQWNJLFFBQVFELE9BQXpERixHQUFVRSxRQUFBSCxFQUFBSSxRQUFBRCxLQUFkRSxPQUF1Q0wsRUFBY0ksUUFBUUQsYUFHakRILEVBQWNJLFVBQVFFLFNBQUFBLFdBRzlCQyxJQUFBQSxFQUFBQSxjQUFzQmxCLFFBQVVDLFVBQVNhLEVBQTdDSyxTQUlFTixFQUFPYixVQUFVUyxPQUFPLFlBQXhCSSxJQUFPYixFQUFVUyxjQUFPLFFBQXhCVyxVQUFBTixFQUFBRSxRQUZGSCxFQUlPYixVQUFBSyxJQUFBLFlBcEZJZ0IsU0FBQSxTQUFBUixFQUFBUyxHQTJGWFQsRUFBT1UsU0FBV1YsRUFBT2IsVUFBVUMsU0FBUyxVQUQ5Q29CLEVBQVVuQixNQUFBc0IsT0FBQ1gsRUFBUVMsa0JBQWdCRyxhQUFBLEtBQ2pDWixFQUFBWCxNQUFrQlcsT0FBT2IsT0FLM0IwQixhQUFjLFNBQUFDLEdBQ1osSUFBSUMsRUFBT0MsS0FDWEEsS0FBS0MsZ0JBQWdCSCxFQUFPLGNBQzVCSSxXQUFXLFdBQVdILEVBQUFJLFdBQUFMLEVBQUEsZUFBQSxLQW5HWE0sb0JBQUEsV0F1R1gsT0FBT0MsT0FBT0MsYUFBZTdCLFNBQVM4QixnQkFBZ0JDLFdBdkczQ0wsV0FBQSxTQUFBdEMsRUFBQTRDLEdBMkdYLElBQUlDLEVBQU9WLEtBQUtwQyxVQUFVQyxHQUQ1QnNDLEVBQVloQyxVQUFBQyxTQUFTUCxJQUNmNkMsRUFBQUEsVUFBWTlDLElBQUFBLElBR2ZxQyxnQkFBQSxTQUFBcEMsRUFBQTRDLEdBOUdVLElBQUFDLEVBQUFWLEtBQUFwQyxVQUFBQyxHQWdIYm9DLEVBQUFBLFVBQWlCN0IsU0FBQXFDLElBQ1hDLEVBQUFBLFVBQVk5QyxPQUFVQyxJQWpIZjhDLGtCQUFBLFNBQUFDLEVBQUFuQixFQUFBb0IsR0F3SFBELEVBQU1FLGNBRFpILFFBQUFBLElBQUFBLEVBQW1CRyxjQUdoQkYsRUFBQUcsWUFHQ3pELFFBQVEwRCxJQUFJSixFQUFNRyxhQTdIVEUsb0JBQUEsU0FBQUMsR0FtSVgsSUFEQSxJQUFJQyxFQUFXRCxFQUFPQyxTQUR4QkYsRUFBQUEsRUFFTUcsRUFBSixFQUFBQyxFQUFBRixFQUFBRyxPQUFBRCxJQUdFRCxHQUFrQkQsRUFBU0UsR0FBR0UsWUFBOUJILE9BQUFBLEdBdElTSSxnQkFBQSxTQUFBM0QsR0E0SVgsSUFERjJELEVBQ2F4QixLQUFLcEMsVUFBVUMsR0FEWDRELHdCQUVmLE9BR0VDLElBQUtDLEVBQUlELElBQU1wQixZQURqQnNCLEtBQU9ELEVBQUFDLEtBQUFDLFlBQ0xILE9BQVNBLEVBQU1wQixPQUFBQSxjQWhKTndCLGtCQUFBLFNBQUFqRSxHQXVKWCxJQURGaUUsRUFDYTlCLEtBQUtwQyxVQUFVQyxHQUQ1QmlFLHdCQUVFLE9BR0VKLElBQUtDLEVBQUlELElBRFhFLEtBQU9ELEVBQUFDLEtBQ0xGLE9BQVNBLEVBREpLLE9BRUxILE1BQVVBLEVBRkxJLE1BR0xELE1BQVFKLEVBQUlJLE1BQ1pDLE9BQVdBLEVBQUFBLFNBOUpGQyxVQUFBLFNBQUFwRSxHQXFLWEEsRUFBUVEsTUFBTTZELE1BQVFqQixvQkFBb0JwRCxHQUFXLE1BQXJEQSxjQUFjcUUsU0FBUWpCLEdBcktYcEQsRUFBQVEsTUFBQTZELE1BQUEsS0FBQUMsVUFBQSxTQUFBekIsRUFBQTBCLEdBMktiRCxJQUFBQSxPQUFBQSxFQUNFRSxFQUFBRCxHQUFBLFFBQ0EsSUFBSUMsRUFBSmhDLE9BQUFDLFlBQ0E4QixFQUFBM0QsU0FBOEI4QixnQkFBOUIrQixhQUNJQyxFQUFZbEMsRUFBT0Msd0JBQXZCb0IsSUFBQXBCLFlBQ0lrQyxFQUFlL0QsRUFBUzhCLEVBQUFBLGFBRTVCLE1BQUlrQyxTQUFBQSxFQUdFaEUsU0FBUzhCLGdCQUFnQm1DLFlBQWMsSUFEbENELEdBQVNGLEVBQUFDLEdBQUFHLEdBQUFKLEVBRVJFLEdBQWtCRixFQUFZQyxFQUFrQkcsR0FBQUEsR0FBeERKLEVBSUgsYUFBQUYsRUFFVU0sR0FBYUosRUFBQSxLQUFBSSxHQUFBSixFQUFBQyxFQUd2QixlQUFBSCxFQUdRTSxHQUFlSixFQUFZQyxPQUhuQyxHQS9MVUksaUJBQUEsU0FBQS9FLEVBQUFxRCxHQTJNWCxJQUFJMkIsRUFBa0JoRixFQUFRNEQsd0JBQXdCRyxLQUFPVixFQUFPTyx3QkFBd0JHLEtBRDlGZ0IsRUFBa0IvRSxFQUFBNEQsd0JBQWtCUCxNQUFRQSxFQUFBTyx3QkFBQU8sTUFDMUMsT0FBSWEsR0FBa0JoRixHQTNNWGlGLFlBQUEsU0FBQWpGLEdBaU5YLE9BQU9BLEVBQVFrRixvQkFBZkMsYUFBT25GLFNBQVFrRixHQWpOSixPQUFBbEYsRUFBQW9GLHlCQTBOWEMsS0FBTyxtQkFJWEMsRUFBRTFFLFVBQVUyRSxNQUFNLFdBQWxCRCxRQUFFMUUsSUFBVTJFLGtCQUtYRixLQUFPLGtCQThnQ1AzRixLQUFLQyxlQUFpQmlCLFNBQVM0RSxlQUFlLGtCQUM5QzlGLEtBQUtFLFFBQVVnQixTQUFTNEUsZUFBZSxXQUN2QzlGLEtBQUtHLFlBQWNlLFNBQVM0RSxlQUFlLGVBRXRDRixFQUFFLFNBQVU3RixRQUFRMEQsSUFBSSxnQkFjN0JtQyxFQUFFLG1CQUFtQkcsR0FBRyxRQUFTLFdBQ2hDM0YsU0FBU2tCLG9CQUFvQm1CLE1BQzdCckMsU0FBUzZCLFNBQVNRLEtBQU16QyxLQUFLQyxrQkFNOUIyRixFQUFFLFFBQVFHLEdBQUcsUUFBUyxnQkFBaUIsV0FFckMsSUFBSUMsRUFBUUosRUFBRSxnQkFDVEksRUFBTWpDLFFBQ1YvRCxLQUFLaUcsWUFBWUMsVUFBVUYsRUFBTyx5QkFJcENKLEVBQUUsUUFBUUcsR0FBRyxRQUFTLFVBQVcsV0FFaEMsSUFBSUMsRUFBUTlFLFNBQVM0RSxlQUFlLE1BQy9CRSxHQUNKaEcsS0FBS2lHLFlBQVlDLFVBQVVGLEtBOEI5QkosRUFBRSwwQkFBMEJPLFdBQVkvRCxPQUFRLEdBQUlnRSxTQUFVLE9BQVFDLE9BQU8sSUFDN0VULEVBQUUsbUJBQW1CTyxXQUFZL0QsT0FBUSxHQUFJZ0UsU0FBVSxPQUFRQyxPQUFPLElBdUJ0RSxJQUFJQyxFQUFhcEYsU0FBU3FGLGlCQUFpQixvQkFFM0MsR0FBSUQsRUFBV3ZDLE9BQ2QsSUFBSyxJQUFJRCxFQUFJLEVBQUdBLEVBQUl3QyxFQUFXdkMsT0FBUUQsS0FDdEN3QyxFQUFXeEMsR0FBRzlCLFdBQW1Cc0UsRUFBV3hDLEdBQUcwQyxjQUFjQyxZQUFZSCxFQUFXeEMsSUF5QnRGOEIsRUFBRSxVQUFVYyxPQUNYQyxNQUFNLEVBQ05DLFVBQVUsRUFDVkMsTUFBTyxJQUNQQyxNQUFNLEVBQ05DLFFBQVMsU0FDVEMsVUFBVXBCLEVBQUUsU0FDTnFCLFVBQVVyQixFQUFFLFdBR2pCQSxFQUFFLFVBQVVjLE9BQ1BNLFVBQVcseURBQ1hDLFVBQVcsZ0VBR2xCckIsRUFBRSxRQUFRYyxPQUNURSxVQUFVLEVBQ1ZNLGFBQWMsRUFDZEMsZUFBZ0IsTUFNbEJyRSxPQUFPc0UsT0FBUyxXQUNmckgsUUFBUTBELElBQUkiLCJmaWxlIjoiaW5kZXgubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsibGV0IHN0YXR1cyA9IFwiSlMgLSBPSyFcIjtcbmZ1bmN0aW9uIGNsKGFyZzEsIGFyZzIsIGFyZzMsIGFyZzQpIHtcblx0Y29uc29sZS5sb2coYXJnMSwgYXJnMiB8fCAnJywgYXJnMyB8fCAnJywgYXJnNCB8fCAnJyk7XG5cdHJldHVybiAnLSc7XG59XG5cbi8vIGNsKHN0YXR1cyk7XG5cblxudmFyIGdsb2IgPSB7XG5cdG5hdk1lbnVXcmFwcGVyOiBudWxsLFxuXHRuYXZNZW51OiBudWxsLFxuXHRwYWdlT3ZlcmxheTogbnVsbCxcblxuXHRzY3JvbGxUb3BCdXR0b246IG51bGwsXG59XG5cbi8vID09PT09PT09PT09PT09PT09XG52YXIgZ2xvYkZ1bmMgPSB7XG4gIHJldHVybkRPTTogZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIHJldHVybiBlbGVtZW50IGluc3RhbmNlb2YgalF1ZXJ5ID8gZWxlbWVudFswXSA6IGVsZW1lbnQ7XG4gIH0sXG5cbiAgc2hvd092ZXJsYXk6IGZ1bmN0aW9uKG92ZXJsYXlUeXBlLCBvdmVybGF5RWxlbWVudCwgYWRkaXRpb25hbENsYXNzKSB7XG4gICAgc3dpdGNoIChvdmVybGF5VHlwZSkge1xuICAgICAgY2FzZSBcInBvcHVwXCI6XG4gICAgICAgIGlmICghb3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqc19vcGVuUG9wdXAnKSkge1xuICAgICAgICAgIG92ZXJsYXlFbGVtZW50LnN0eWxlLnpJbmRleCA9IDExNTA7XG4gICAgICAgICAgb3ZlcmxheUVsZW1lbnQuc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJztcbiAgICAgICAgICBvdmVybGF5RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdqc19vcGVuUG9wdXAnKTtcbiAgICAgICAgICBvdmVybGF5RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdqc19vcGVuJyk7XG4gICAgICAgICAgXG4gICAgICAgICAgYWRkaXRpb25hbENsYXNzID8gb3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LmFkZChhZGRpdGlvbmFsQ2xhc3MpIDogbnVsbDtcblxuICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZChcImpzX3BhZ2VPdmVybGF5T3BlblwiKTtcbiAgICAgICAgfSBcbiAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIFwibWVudVwiOlxuICAgICAgICBpZiAoIW92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnanNfb3Blbk1lbnUnKSkge1xuICAgICAgICAgIG92ZXJsYXlFbGVtZW50LnN0eWxlLnpJbmRleCA9IDkwMDtcbiAgICAgICAgICBvdmVybGF5RWxlbWVudC5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnO1xuICAgICAgICAgIG92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2pzX29wZW5NZW51Jyk7XG4gICAgICAgICAgb3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnanNfb3BlbicpO1xuICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZChcImpzX3BhZ2VPdmVybGF5T3BlblwiKTtcbiAgICAgICAgfSBcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfSxcbiAgaGlkZU92ZXJsYXk6IGZ1bmN0aW9uKG92ZXJsYXlUeXBlLCBvdmVybGF5RWxlbWVudCwgYWRkaXRpb25hbENsYXNzKSB7XG4gICAgc3dpdGNoIChvdmVybGF5VHlwZSkge1xuICAgICAgY2FzZSBcInBvcHVwXCI6XG4gICAgICAgIGlmIChvdmVybGF5RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzX29wZW5Qb3B1cCcpKSB7XG4gICAgICAgICAgb3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnanNfb3BlblBvcHVwJyk7XG4gICAgICAgICAgb3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnanNfb3BlbicpO1xuXG4gICAgICAgICAgYWRkaXRpb25hbENsYXNzID8gb3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShhZGRpdGlvbmFsQ2xhc3MpIDogbnVsbDtcblxuICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZShcImpzX3BhZ2VPdmVybGF5T3BlblwiKTtcbiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghb3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqc19vcGVuUG9wdXAnKSkge1xuICAgICAgICAgICAgICBvdmVybGF5RWxlbWVudC5zdHlsZS56SW5kZXggPSAtMTA7XG4gICAgICAgICAgICAgIG92ZXJsYXlFbGVtZW50LnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LCAzMDApXG4gICAgICAgIH1cbiAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIFwibWVudVwiOlxuICAgICAgICBpZiAob3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqc19vcGVuTWVudScpKSB7XG4gICAgICAgICAgb3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnanNfb3Blbk1lbnUnKTtcbiAgICAgICAgICBvdmVybGF5RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdqc19vcGVuJyk7XG4gICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKFwianNfcGFnZU92ZXJsYXlPcGVuXCIpO1xuICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCFvdmVybGF5RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzX29wZW5NZW51JykpIHtcbiAgICAgICAgICAgICAgb3ZlcmxheUVsZW1lbnQuc3R5bGUuekluZGV4ID0gLTEwO1xuICAgICAgICAgICAgICBvdmVybGF5RWxlbWVudC5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSwgMzAwKVxuICAgICAgICB9XG4gICAgICBicmVhaztcbiAgICB9XG4gIH0sXG5cbiAgdG9nZ2xlQnV0dG9uQ29udGVudDogZnVuY3Rpb24gKGJ1dHRvbkVsZW1lbnQsIHN0ck9iaikge1xuICAgIHZhciBidXR0b24gPSB0aGlzLnJldHVybkRPTShidXR0b25FbGVtZW50KTtcbiAgICB2YXIgdGV4dDtcblxuICAgIC8vIGNvbnNvbGUubG9nKGJ1dHRvbkVsZW1lbnQpXG5cbiAgICBpZiAoc3RyT2JqKSB7IHRleHQgPSBzdHJPYmogfSBlbHNlIGlmIChidXR0b25FbGVtZW50LmRhdGFzZXQudGV4dCkge1xuICAgICAgdGV4dCA9IHtcbiAgICAgICAgZGVmYXVsdDogYnV0dG9uRWxlbWVudC5kYXRhc2V0LnRleHQsXG4gICAgICAgIGFjdGl2ZTogYnV0dG9uRWxlbWVudC5kYXRhc2V0LnRleHRBY3RpdmVcbiAgICAgIH1cbiAgICB9XG4gICAgbGV0IGJ1dHRvbkFjdGl2ZSA9IGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpO1xuXG4gICAgaWYgKGJ1dHRvbkFjdGl2ZSkge1xuICAgICAgdGV4dCA/IGJ1dHRvbi5xdWVyeVNlbGVjdG9yKCdzcGFuJykuaW5uZXJIVE1MID0gdGV4dC5kZWZhdWx0IDogbnVsbDtcbiAgICAgIGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcblxuICAgIH0gZWxzZSB7XG4gICAgICB0ZXh0ID8gYnV0dG9uLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKS5pbm5lckhUTUwgPSB0ZXh0LmFjdGl2ZSA6IG51bGw7XG4gICAgICBidXR0b24uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4gICAgfVxuICB9LFxuXG4gIGRyb3BEb3duOiAoYnV0dG9uLCB0YXJnZXRCbG9jaykgPT4ge1xuICAgIGJ1dHRvbi5jaGVja2VkIHx8IGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpID8gXG4gICAgdGFyZ2V0QmxvY2suc3R5bGUuaGVpZ2h0ID0gdGFyZ2V0QmxvY2suZmlyc3RFbGVtZW50Q2hpbGQub2Zmc2V0SGVpZ2h0ICsgJ3B4JyA6XG4gICAgdGFyZ2V0QmxvY2suc3R5bGUuaGVpZ2h0ID0gXCIwcHhcIjsgICAgXG4gIH0sXG5cbiAgYW5pbWF0ZUJsb2NrOiBmdW5jdGlvbiAoYmxvY2spIHtcbiAgICBsZXQgc2VsZiA9IHRoaXM7XG4gICAgdGhpcy5yZW1vdmVDbGFzc0Zyb20oYmxvY2ssICdqc19hbmltYXRlJyk7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtzZWxmLmFkZENsYXNzVG8oYmxvY2ssICdqc19hbmltYXRlJykgfSwgNTApXG4gIH0sXG5cbiAgZ2V0Q3VycmVudFlQb3NpdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHdpbmRvdy5wYWdlWU9mZnNldCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wO1xuICB9LFxuXG4gIGFkZENsYXNzVG86IGZ1bmN0aW9uKGVsZW1lbnQsIGFjdGl2ZUNsYXNzKSB7XG4gICAgdmFyIGVsZW0gPSB0aGlzLnJldHVybkRPTShlbGVtZW50KTtcbiAgICBpZiAoIWVsZW0uY2xhc3NMaXN0LmNvbnRhaW5zKGFjdGl2ZUNsYXNzKSkge1xuICAgICAgZWxlbS5jbGFzc0xpc3QuYWRkKGFjdGl2ZUNsYXNzKTtcbiAgICB9XG4gIH0sXG4gIHJlbW92ZUNsYXNzRnJvbTogZnVuY3Rpb24oZWxlbWVudCwgYWN0aXZlQ2xhc3MpIHtcbiAgICB2YXIgZWxlbSA9IHRoaXMucmV0dXJuRE9NKGVsZW1lbnQpO1xuICAgIGlmIChlbGVtLmNsYXNzTGlzdC5jb250YWlucyhhY3RpdmVDbGFzcykpIHtcbiAgICAgIGVsZW0uY2xhc3NMaXN0LnJlbW92ZShhY3RpdmVDbGFzcyk7XG4gICAgfVxuICB9LFxuXG4gIHRyYW5zaXRpb25IYW5kbGVyOiBmdW5jdGlvbihldmVudCwgdGFyZ2V0QmxvY2ssIGhpZGRlbkNvbnRlbnQpIHtcbiAgICBpZiAoZXZlbnQucHJvcGVydHlOYW1lKSB7XG4gICAgICBjb25zb2xlLmxvZyhldmVudC5wcm9wZXJ0eU5hbWUpICAvLyB5b3VyIGNvZGUgaGVyZVxuICAgIH1cblxuICAgIGlmIChldmVudC5zcmNFbGVtZW50KSB7XG4gICAgICBjb25zb2xlLmxvZyhldmVudC5zcmNFbGVtZW50KSAgLy8geW91ciBjb2RlIGhlcmVcbiAgICB9XG4gIH0sXG5cbiAgZ2V0Q2hpbGRzVG90YWxXaWR0aDogZnVuY3Rpb24ocGFyZW50KSB7XG4gICAgbGV0IGNoaWxkcmVuID0gcGFyZW50LmNoaWxkcmVuO1xuICAgIGxldCByZXN1bHQgPSAwO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuICAgICAgcmVzdWx0ID0gcmVzdWx0ICsgY2hpbGRyZW5baV0ub2Zmc2V0V2lkdGg7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH0sXG5cbiAgZ2V0Q29vcmRzT25QYWdlOiBmdW5jdGlvbihlbGVtZW50KSB7IFxuICAgIHZhciBlbGVtID0gdGhpcy5yZXR1cm5ET00oZWxlbWVudCk7XG4gICAgdmFyIGJveCA9IGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgdG9wOiBib3gudG9wICsgcGFnZVlPZmZzZXQsXG4gICAgICBsZWZ0OiBib3gubGVmdCArIHBhZ2VYT2Zmc2V0LFxuICAgICAgYm90dG9tOiBib3guYm90dG9tICsgcGFnZVlPZmZzZXRcbiAgICB9O1xuICB9LFxuXG4gIGdldENvb3Jkc09uU2NyZWVuOiBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgdmFyIGVsZW0gPSB0aGlzLnJldHVybkRPTShlbGVtZW50KTtcbiAgICB2YXIgYm94ID0gZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgIHJldHVybiB7XG4gICAgICB0b3A6IGJveC50b3AsXG4gICAgICBsZWZ0OiBib3gubGVmdCxcbiAgICAgIGJvdHRvbTogYm94LmJvdHRvbSxcbiAgICAgIHJpZ2h0OiBib3gucmlnaHQsXG4gICAgICB3aWR0aDogYm94LndpZHRoLFxuICAgICAgaGVpZ2h0OiBib3guaGVpZ2h0LFxuICAgIH07XG4gIH0sXG5cbiAgb3BlbldpZHRoOiBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgZWxlbWVudC5zdHlsZS53aWR0aCA9IGdldENoaWxkc1RvdGFsV2lkdGgoZWxlbWVudCkgKyAncHgnO1xuICB9LFxuICBjb2xsYXBzZVdpZHRoOiBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgZWxlbWVudC5zdHlsZS53aWR0aCA9ICcwJztcbiAgfSxcblxuICBpc1Zpc2libGU6IGZ1bmN0aW9uKGVsZW0sIG9wdGlvbikge1xuICAgIC8vIHZhciBlbGVtID0gdGhpcy5yZXR1cm5ET00oZWxlbWVudCk7XG4gICAgbGV0IG9wdDtcbiAgICBvcHRpb24gPyBvcHQgPSBvcHRpb24gOiBvcHQgPSBcIndob2xlXCI7XG4gICAgdmFyIHdpbmRvd1RvcCA9IHdpbmRvdy5wYWdlWU9mZnNldDtcbiAgICB2YXIgd2luZG93SGVpZ2h0ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodDtcbiAgICB2YXIgZWxlbVBhZ2VUb3AgPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCArIHBhZ2VZT2Zmc2V0O1xuICAgIHZhciBlbGVtUGFnZUJvdHRvbSA9IGVsZW1QYWdlVG9wICsgZWxlbS5vZmZzZXRIZWlnaHQ7XG5cbiAgICBpZiAob3B0ID09IFwid2hvbGVcIikge1xuICAgICAgaWYgKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCA+IDk5MSkge1xuICAgICAgICByZXR1cm4gKGVsZW1QYWdlQm90dG9tIDw9IHdpbmRvd1RvcCArIHdpbmRvd0hlaWdodCkgJiYgKGVsZW1QYWdlVG9wID49IHdpbmRvd1RvcCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gKCBlbGVtUGFnZVRvcCA8PSAod2luZG93VG9wICsgd2luZG93SGVpZ2h0IC8gMikgKSAmJiAoZWxlbVBhZ2VUb3AgPj0gd2luZG93VG9wKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAob3B0ID09IFwidG9wQm9yZGVyXCIpIHtcbiAgICAgIC8vIGNvbnNvbGUubG9nKHdpbmRvd1RvcClcbiAgICAgIHJldHVybiAoZWxlbVBhZ2VUb3AgPj0gd2luZG93VG9wICsgMTMwKSAmJiAoZWxlbVBhZ2VUb3AgPD0gd2luZG93VG9wICsgd2luZG93SGVpZ2h0KTtcbiAgICB9XG5cbiAgICBpZiAob3B0ID09IFwidG9wQm9yZGVySW5cIikge1xuICAgICAgcmV0dXJuIGVsZW1QYWdlVG9wIDw9IHdpbmRvd1RvcCArIHdpbmRvd0hlaWdodDtcbiAgICB9XG5cbiAgICBpZiAob3B0ID09IFwiYm90dG9tQm9yZGVyXCIpIHtcbiAgICAgIC8vIHJldHVybiBlbGVtUGFnZVRvcCA+PSB3aW5kb3dUb3AgKyAxMDtcbiAgICB9XG4gIH0sXG5cbiAgaXNWaXNpYmxlT25YQXhpczogZnVuY3Rpb24oZWxlbWVudCwgcGFyZW50KSB7XG4gICAgbGV0IGlzVmlzaWJsZU9uTGVmdCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCA+IHBhcmVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0O1xuICAgIGxldCBpc1Zpc2libGVPblJpZ2h0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5yaWdodCA8IHBhcmVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5yaWdodDtcbiAgICByZXR1cm4gaXNWaXNpYmxlT25MZWZ0ICYmIGlzVmlzaWJsZU9uUmlnaHQ7XG4gIH0sXG5cbiAgaXNMYXN0Q2hpbGQ6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICByZXR1cm4gZWxlbWVudC5uZXh0RWxlbWVudFNpYmxpbmcgPyBmYWxzZSA6IHRydWU7XG4gIH0sXG4gIGlzRmlyc3RDaGlsZDogZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIHJldHVybiBlbGVtZW50LnByZXZpb3VzRWxlbWVudFNpYmxpbmcgPyBmYWxzZSA6IHRydWU7XG4gIH0sXG59XG4vLyA9PT09PT09PT09PT09PT1cblxuXG52YXIgdGVzdCA9ICdpbmNsdWRlIGpzIGVycm9yJztcblxuLy8gaW1wb3J0IHsgZHJvcERvd24gfSBmcm9tICcuL2ZyYW1lcy9nbG9iYWxGdW5jdGlvbnMnXG5cbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xuXHRjb25zb2xlLmxvZygnZG9jdW1lbnQgcmVhZHknKVxuXHQvLyBjb25zb2xlLmxvZyhkcm9wRG93bilcdFxuXHQvLyA9PT09PT09PT09PT09PT09PUluY2x1ZGUgTW9kdWxlcz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5cdHRlc3QgPSAnaW5jbHVkZSBqcyAtIE9LJztcblxuXG4gIC8qLy8gY29uc29sZS5sb2coJ1BvcHVwTW9kdWxlIG9rJyk7XG4vLyA9PT09PT09PT09PT09PVBvcHVwIE9wZW4vQ2xvc2UgTW9kdWxlID09PT09PT09PT09PT09XG5nbG9iLlBvcHVwTW9kdWxlID0gKGZ1bmN0aW9uICgpIHtcbiAgdmFyIGFkZGl0aW9uYWxDbGFzc1N0cjtcbiAgbGV0IG1vZGFscyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3BvcHVwJyk7XG4gIGNvbnN0IHBhZ2VPdmVybGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhZ2VPdmVybGF5Jyk7XG5cblxuICBmdW5jdGlvbiB0b2dnbGVTaG93KGV2ZW50LCBwb3B1cEJsb2NrKSB7XG4gICAgdmFyIHBvcHVwID0gZ2xvYkZ1bmMucmV0dXJuRE9NKHBvcHVwQmxvY2spO1xuXG4gICAgaWYgKCBldmVudC5wcm9wZXJ0eU5hbWUgPT0gJ3RyYW5zZm9ybScgfHwgIGV2ZW50LnByb3BlcnR5TmFtZSA9PSAnb3BhY2l0eScpIHtcbiAgICAgIHBvcHVwLmNsYXNzTGlzdC5jb250YWlucygnanNfYW5pbWF0ZScpID8gbnVsbCA6IHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ2pzX29wZW4nKTtcbiAgICB9XG4gIH1cblxuICBpZiAobW9kYWxzLmxlbmd0aCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbW9kYWxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBtb2RhbHNbaV0uYWRkRXZlbnRMaXN0ZW5lcihcInRyYW5zaXRpb25lbmRcIiwgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIHRvZ2dsZVNob3coZXZlbnQsIG1vZGFsc1tpXSlcbiAgICAgIH0sIGZhbHNlKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBvcGVuUG9wdXAocG9wdXBCbG9jaywgYWRkaXRpb25hbENsYXNzLCBvdmVybGF5QmxvY2spIHtcbiAgICBsZXQgb3ZlcmxheSA9IG92ZXJsYXlCbG9jayB8fCBwYWdlT3ZlcmxheTtcblxuICAgIHZhciBwb3B1cCA9IGdsb2JGdW5jLnJldHVybkRPTShwb3B1cEJsb2NrKTtcbiAgICAgICAgcG9wdXAuY2xhc3NMaXN0LmFkZChcImpzX29wZW5cIik7XG4gICAgICAgIHBvcHVwLmNsYXNzTGlzdC5hZGQoXCJqc19hbmltYXRlXCIpO1xuXG4gICAgaWYgKGFkZGl0aW9uYWxDbGFzcykge1xuICAgICAgYWRkaXRpb25hbENsYXNzU3RyID0gYWRkaXRpb25hbENsYXNzO1xuICAgICAgZ2xvYkZ1bmMuc2hvd092ZXJsYXkoXCJwb3B1cFwiLCBvdmVybGF5LCBhZGRpdGlvbmFsQ2xhc3MpIFxuICAgIH0gZWxzZSB7XG4gICAgICBnbG9iRnVuYy5zaG93T3ZlcmxheShcInBvcHVwXCIsIG92ZXJsYXkpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGNsb3NlUG9wdXAocG9wdXBCbG9jaykge1xuICAgIC8vIGxldCBvdmVybGF5ID0gb3ZlcmxheUJsb2NrIHx8IHBhZ2VPdmVybGF5O1xuICAgIHZhciBwb3B1cCA9IGdsb2JGdW5jLnJldHVybkRPTShwb3B1cEJsb2NrKTtcbiAgICBcbiAgICBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwianNfYW5pbWF0ZVwiKTtcbiAgICAvLyBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwianNfb3BlblwiKTtcbiAgICAvLyBhZGRpdGlvbmFsQ2xhc3MgPyBoaWRlT3ZlcmxheShcInBvcHVwXCIsIG92ZXJsYXksIGFkZGl0aW9uYWxDbGFzcykgOiBoaWRlT3ZlcmxheShcInBvcHVwXCIsIG92ZXJsYXkpO1xuICB9XG5cbiAgLy8gLS0tLS0tLUV2ZW50cy0tLS0tLS0tICBcblxuICAkKCdib2R5Jykub24oJ2NsaWNrJywgJyNwYWdlT3ZlcmxheScsIGZ1bmN0aW9uKGUpIHtcbiAgICAvLyBjb25zb2xlLmxvZyhlKVxuICAgIGdsb2JGdW5jLmhpZGVPdmVybGF5KFwicG9wdXBcIiwgdGhpcywgYWRkaXRpb25hbENsYXNzU3RyKTtcblxuICAgIGlmIChtb2RhbHMpIHtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbW9kYWxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIG1vZGFsc1tpXS5jbGFzc0xpc3QuY29udGFpbnMoJ2pzX29wZW4nKSA/IGNsb3NlUG9wdXAobW9kYWxzW2ldKSA6IG51bGw7XG4gICAgICB9ICAgICAgIFxuICAgIH1cbiAgfSk7XG4gICBcbiAgJCgnYm9keScpLm9uKCdjbGljaycsICdidXR0b24ucG9wdXBDbG9zZUJ1dHRvbicsIGZ1bmN0aW9uKCkge1xuICAgIC8vIGNvbnNvbGUubG9nKCdvaycpXG5cbiAgICBjbG9zZVBvcHVwKCAkKHRoaXMpLmNsb3Nlc3QoJy5wb3B1cCcpICk7XG4gICAgZ2xvYkZ1bmMuaGlkZU92ZXJsYXkoXCJwb3B1cFwiLCBwYWdlT3ZlcmxheSwgYWRkaXRpb25hbENsYXNzU3RyKTtcbiAgfSk7XG5cbiAgJCgnYm9keScpLm9uKCdtb3VzZWRvd24nLCAnLnBvcHVwJywgZnVuY3Rpb24oZSkge1xuICAgIC8vIGNvbnNvbGUubG9nKGUudGFyZ2V0KVxuICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwJykpIHtcbiAgICAgIGNsb3NlUG9wdXAoIGUudGFyZ2V0ICk7XG4gICAgICBnbG9iRnVuYy5oaWRlT3ZlcmxheShcInBvcHVwXCIsIHBhZ2VPdmVybGF5LCBhZGRpdGlvbmFsQ2xhc3NTdHIpO1xuICAgIH1cbiAgfSk7XG5cbiAgd2luZG93Lm9ua2V5ZG93biA9IGZ1bmN0aW9uIChlKSB7XG4gICAgaWYgKGUua2V5Q29kZSA9PT0gMjcgKSB7XG4gICAgICBpZiAocGFnZU92ZXJsYXkpIHtcbiAgICAgICAgcGFnZU92ZXJsYXkuY2xhc3NMaXN0LmNvbnRhaW5zKCdqc19vcGVuJykgPyBnbG9iRnVuYy5oaWRlT3ZlcmxheShcInBvcHVwXCIsIHBhZ2VPdmVybGF5LCBhZGRpdGlvbmFsQ2xhc3NTdHIpIDogbnVsbDtcbiAgICAgIH1cblxuICAgICAgaWYgKG1vZGFscykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1vZGFscy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIG1vZGFsc1tpXS5jbGFzc0xpc3QuY29udGFpbnMoJ2pzX29wZW4nKSA/IGNsb3NlUG9wdXAobW9kYWxzW2ldKSA6IG51bGw7XG4gICAgICAgIH0gICAgICAgXG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIC8vIC0tLS0tLS0tLS0tLVxuXG4gIHJldHVybiB7XG4gICAgb3BlblBvcHVwOiBvcGVuUG9wdXAsXG4gICAgY2xvc2VQb3B1cDogY2xvc2VQb3B1cCxcbiAgfVxuXG59KSgpO1xuXG4vLyBnbG9iLlBvcHVwTW9kdWxlKClcblxuLy8gKGZ1bmN0aW9uKCkge1xuXG5cblxuLy8gfSkuY2FsbChnbG9iLlBvcHVwTW9kdWxlLnByb3RvdHlwZSkqL1xuICAvKlZhbGlkYXRpb25Nb2R1bGUgPSAoZnVuY3Rpb24oKSB7XG5cdGZ1bmN0aW9uIHZhbGlkYXRlKGlucHV0RWxlbWVudCwgdmFsaWRhdGlvbnNBcnJheSkge1xuXHRcdGNvbnN0IHZhbGlkYXRpb25zID0gdmFsaWRhdGlvbnNBcnJheTtcblx0XHRsZXQgbWVzc2FnZXMgPSBbXTtcblxuXHRcdGZ1bmN0aW9uIGlzTnVtYmVyKGlucHV0KSB7XG5cdFx0XHRyZXR1cm4gIWlzTmFOKHBhcnNlRmxvYXQoaW5wdXQudmFsdWUpKSAmJiBpc0Zpbml0ZShpbnB1dC52YWx1ZSk7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gaXNFbWFpbChpbnB1dCkge1xuXHRcdFx0dmFyIHJlZ2V4ID0gL14oW2EtekEtWjAtOV8uKy1dKStcXEAoKFthLXpBLVowLTktXSkrXFwuKSsoW2EtekEtWjAtOV17Miw0fSkrJC87XG5cdFx0XHRcblx0XHRcdHJldHVybiByZWdleC50ZXN0KGlucHV0LnZhbHVlKTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBpc0VtcHR5KGlucHV0KSB7XG5cdFx0XHRyZXR1cm4gaW5wdXQudmFsdWUucmVwbGFjZSgvXFxzL2csXCJcIikubGVuZ3RoID8gZmFsc2UgOiB0cnVlO1xuXHRcdH1cblxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB2YWxpZGF0aW9ucy5sZW5ndGg7IGkrKykge1xuXG5cdFx0XHRzd2l0Y2ggKHZhbGlkYXRpb25zW2ldKSB7XG5cdFx0XHRcdGNhc2UgJ3JlcXVpcmVkJzogXG5cdFx0XHRcdFx0aWYgKCBpc0VtcHR5KGlucHV0RWxlbWVudCkgKSB7XG5cdFx0XHRcdFx0XHRtZXNzYWdlcy5wdXNoKGlucHV0RWxlbWVudC5kYXRhc2V0LmVycm9yVGV4dClcblx0XHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgJ2lzTnVtYmVyJzogXG5cdFx0XHRcdFx0aWYgKCAhaXNOdW1iZXIoaW5wdXRFbGVtZW50KSApIHtcblx0XHRcdFx0XHRcdG1lc3NhZ2VzLnB1c2goaW5wdXRFbGVtZW50LmRhdGFzZXQuZXJyb3JUZXh0KVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0Y2FzZSAnaXNFbWFpbCc6IFxuXHRcdFx0XHRcdGlmICggIWlzRW1haWwoaW5wdXRFbGVtZW50KSApIHtcblx0XHRcdFx0XHRcdG1lc3NhZ2VzLnB1c2goaW5wdXRFbGVtZW50LmRhdGFzZXQuZXJyb3JUZXh0KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGRlZmF1bHQ6IGNvbnNvbGUuZXJyb3IoJ2ludmFsaWQgaW5wdXQgZGF0YS12YWxpZGF0ZSB2YWx1ZScpXG5cblx0XHRcdH1cblx0XHR9XG5cdFx0Ly8gY29uc29sZS5sb2cobWVzc2FnZXMubGVuZ3RoID8gbWVzc2FnZXMgOiBudWxsKVxuXHRcdHJldHVybiBtZXNzYWdlcy5sZW5ndGggPyBtZXNzYWdlcyA6IG51bGw7XG5cdH1cblxuXHRmdW5jdGlvbiBzaG93V2FybmluZyhpbnB1dEVsZW1lbnQsIG1lc3NhZ2VzLCB0ZXh0Q29sb3IpIHtcblx0XHRpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnanNfY29udGFpbnNFcnJvcicpO1xuXHRcdGxldCB3YXJuaW5nTGlzdCA9ICQoJzx1bCBjbGFzcz1cImpzX3dhcm5pbmctbGlzdFwiPjwvdWw+Jyk7XG5cblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IG1lc3NhZ2VzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRsZXQgbGlzdEVsZW1lbnQgPSAkKFwiPGxpPjwvbGk+XCIpLnRleHQobWVzc2FnZXNbaV0pO1xuXHRcdFx0dGV4dENvbG9yID8gbGlzdEVsZW1lbnQuY3NzKCdjb2xvcicsIHRleHRDb2xvcikgOiBudWxsO1xuXHRcdFx0d2FybmluZ0xpc3QuYXBwZW5kKGxpc3RFbGVtZW50KVxuXHRcdH1cblx0XHRcblx0XHQkKGlucHV0RWxlbWVudCkuYWZ0ZXIod2FybmluZ0xpc3QpXG5cdH1cblxuXHRmdW5jdGlvbiBpc1ZhbGlkKGZvcm1FbGVtZW50KSB7XG5cdFx0Y29uc3QgZm9ybSA9IGZvcm1FbGVtZW50IGluc3RhbmNlb2YgalF1ZXJ5ID8gZm9ybUVsZW1lbnRbMF0gOiBmb3JtRWxlbWVudDtcblx0XHRjb25zdCBpbnB1dHMgPSBmb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLXZhbGlkYXRlXScpO1xuXHRcdGxldCBlcnJvcnNDb3VudGVyID0gMDtcblxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgaW5wdXRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRsZXQgZXJyb3JNZXNzYWdlcyA9IFtdO1xuXHRcdFx0bGV0IHRleHRDb2xvciA9IGlucHV0c1tpXS5kYXRhc2V0LnRleHRDb2xvcjtcblxuXHRcdFx0JChpbnB1dHNbaV0pLnJlbW92ZUNsYXNzKFwianNfY29udGFpbnNFcnJvclwiKTtcblx0XHRcdCQoaW5wdXRzW2ldKS5uZXh0KCcuanNfd2FybmluZy1saXN0JykucmVtb3ZlKCk7XG5cblx0XHRcdGxldCB2YWxpZGF0aW9uc0FycmF5ID0gW107XG5cdFx0XHRsZXQgaW5wdXREYXRhID0gaW5wdXRzW2ldLmRhdGFzZXQudmFsaWRhdGUgPyBpbnB1dHNbaV0uZGF0YXNldC52YWxpZGF0ZS5zcGxpdCgnICcpIDogZmFsc2U7XG5cblx0XHRcdC8vIC0tLS0tLS0tLVxuXHRcdFx0aW5wdXRzW2ldLnZhbHVlID0gaW5wdXRzW2ldLnZhbHVlLnRyaW0oKTtcblx0XHRcdC8vIC0tLS0tLS0tLVxuXG5cdFx0XHR2YWxpZGF0aW9uc0FycmF5ID0gaW5wdXREYXRhID8gaW5wdXREYXRhIDogbnVsbDtcblx0XHRcdC8vIGlucHV0c1tpXS5yZXF1aXJlZCA/IHZhbGlkYXRpb25zQXJyYXkucHVzaCgncmVxdWlyZWQnKSA6IG51bGw7XG5cdFx0XHRcblx0XHRcdGlmICh2YWxpZGF0aW9uc0FycmF5Lmxlbmd0aCkge1xuXHRcdFx0XHRsZXQgdmFsaWRhdGlvblJlc3VsdCA9IHZhbGlkYXRlKGlucHV0c1tpXSwgdmFsaWRhdGlvbnNBcnJheSk7XG5cdFx0XHRcdHZhbGlkYXRpb25SZXN1bHQgPyBlcnJvck1lc3NhZ2VzID0gdmFsaWRhdGlvblJlc3VsdCA6IG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChlcnJvck1lc3NhZ2VzLmxlbmd0aCkgeyBcblx0XHRcdFx0c2hvd1dhcm5pbmcoaW5wdXRzW2ldLCBlcnJvck1lc3NhZ2VzLCB0ZXh0Q29sb3IpO1xuXHRcdFx0XHRlcnJvcnNDb3VudGVyKys7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGVycm9yc0NvdW50ZXIgPiAwID8gZmFsc2UgOiB0cnVlO1xuXHR9XG5cblx0Ly8gLS0tLS0tLS0tLS0tLS0tXG5cdHJldHVybiB7XG5cdFx0aXNWYWxpZDogaXNWYWxpZCxcblx0fVxufSkoKVxuXG4vLyAtLS0tLS0tLS1WYWxpZGF0aW9uIFNjcmlwdCBUZXN0LS0tLS0tLS0tLS0tLVxuXG4vLyAkKCdib2R5Jykub24oJ2NsaWNrJywgJ2J1dHRvblt0eXBlPVwic3VibWl0XCJdJywgZnVuY3Rpb24oZSkge1xuLy8gXHQvLyBjb25zb2xlLmxvZygnb2snKVxuLy8gXHRlLnByZXZlbnREZWZhdWx0KCk7XG5cbi8vIFx0Ly8gVmFsaWRhdGlvbk1vZHVsZS5pc1ZhbGlkKHRoaXMuZm9ybSlcbi8vIFx0aWYoICFWYWxpZGF0aW9uTW9kdWxlLmlzVmFsaWQodGhpcy5mb3JtKSApIHtcbi8vIFx0XHRjb25zb2xlLmxvZygnZm9ybSBub3QgdmFsaWQ6ICcsIHRoaXMuZm9ybSlcbi8vIFx0fSBlbHNlIHtcbi8vIFx0XHRjb25zb2xlLmxvZygnZm9ybSB2YWxpZDogJywgdGhpcy5mb3JtKVxuLy8gXHR9XG4vLyB9KSovXG5cdC8qZ2xvYi5BbmltYXRlQm9yZGVyID0gZnVuY3Rpb24gKGFuaW1hdGVkQmxvY2tzLCBvcHRpb25zT2JqKSB7XG5cblx0dmFyIGFuaW1hdGVkRGFzaEJsb2NrcyA9IGFuaW1hdGVkQmxvY2tzO1xuXHR2YXIgb3B0aW9ucyA9IG9wdGlvbnNPYmo7XG5cblx0Ly8gY29uc29sZS5sb2cob3B0aW9ucy5zaGFkZWRTZWN0aW9uKTtcblx0Ly8gLS0tLS0tLS0tLSBNZXRob2RzIC0tLS0tLS0tXG5cblx0ZnVuY3Rpb24gZ2V0VG90YWxMZW5ndGgocGFyZW50QmxvY2ssIHJlY3QpIHtcblx0XHQvLyB2YXIgcmFkaXVzID0gK3JlY3QuZ2V0QXR0cmlidXRlKCdyeCcpO1xuXHRcdHZhciBsZW5ndGggPSAwO1xuXHRcdHZhciByZWN0V2lkdGggPSBwYXJlbnRCbG9jay5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aCAtIChvcHRpb25zLmJvcmRlcldpZHRoICogMik7XG5cdFx0dmFyIHJlY3RIZWlnaHQgPSBwYXJlbnRCbG9jay5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQgLSAob3B0aW9ucy5ib3JkZXJXaWR0aCAqIDIpO1xuXHRcdHZhciByYWRpdXMgPSBvcHRpb25zLnJhZGl1cyA/IHJlY3RIZWlnaHQgLyAyIDogbnVsbDtcblx0XHQvLyBjb25zb2xlLmxvZyhwYXJlbnRCbG9jay5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aClcblx0XHRpZiAocmFkaXVzKSB7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRsZW5ndGg6ICsoIChyZWN0V2lkdGggLSByYWRpdXMqMikgKiAyICkgKyAoIDIqMy4xNCAqIHJhZGl1cyApLFxuXHRcdFx0XHRyYWRpdXM6IHJhZGl1c1xuXHRcdFx0fSBcblx0XHR9IGVsc2Uge1xuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0bGVuZ3RoOiArKCByZWN0V2lkdGggKyByZWN0SGVpZ2h0ICkgKiAyXG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gZ2V0RGFzaEFycmF5U3RyaW5nKHJlY3QsIHJlY3RMZW5ndGgpIHtcblx0XHR2YXIgZGFzaFRvdGFsTGVuZ3RoID0gb3B0aW9ucy5zaGFkZWRTZWN0aW9uICsgb3B0aW9ucy50cmFuc3BhcmVudFNlY3Rpb247XG5cblx0XHR2YXIgZGFzaFF1YW50aXR5ID0gTWF0aC5yb3VuZCggcmVjdExlbmd0aCAvIGRhc2hUb3RhbExlbmd0aCApXG5cdFx0dmFyIGRpZmZlcmVuY2UgPSAoIGRhc2hUb3RhbExlbmd0aCpkYXNoUXVhbnRpdHkgLSByZWN0TGVuZ3RoICkgLyBkYXNoUXVhbnRpdHk7XG5cdFx0XG5cdFx0ZGlmZmVyZW5jZSA9ICggTWF0aC5yb3VuZChkaWZmZXJlbmNlICogMTApIC8gMTAgKSAvIDI7XG5cblx0XHRvcHRpb25zLm5ld1NoYWRlZFNlY3Rpb24gPSBvcHRpb25zLnNoYWRlZFNlY3Rpb24gLSBkaWZmZXJlbmNlO1xuXHRcdG9wdGlvbnMubmV3VHJhbnNwYXJlbnRTZWN0aW9uID0gb3B0aW9ucy50cmFuc3BhcmVudFNlY3Rpb24gLSBkaWZmZXJlbmNlO1xuXG5cdFx0cmV0dXJuIG9wdGlvbnMubmV3U2hhZGVkU2VjdGlvbiArICcgJyArIG9wdGlvbnMubmV3VHJhbnNwYXJlbnRTZWN0aW9uO1xuXHR9XG5cblx0ZnVuY3Rpb24gY3ljbGVPZmZzZXQoZXZlbnQsIGFuaW1hdGVkQmxvY2ssIGRhc2hBcnJheVN1bU51bWJlcikge1xuXHQgIGlmICggZXZlbnQucHJvcGVydHlOYW1lID09ICdzdHJva2UtZGFzaG9mZnNldCcgKSB7XG5cdCAgXHQvLyBjb25zb2xlLmxvZygnc3Ryb2tlLWRhc2hvZmZzZXQnKVxuXHQgIFx0YW5pbWF0ZWRCbG9jay5jbGFzc0xpc3QuYWRkKCdqc19yZXNldFRyYW5zaXRpb24nKTtcblx0ICBcdGFuaW1hdGVkQmxvY2suc2V0QXR0cmlidXRlKCdzdHJva2UtZGFzaG9mZnNldCcsIDApO1xuXHQgIFx0XG5cdCAgXHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHQgIFx0XHRhbmltYXRlZEJsb2NrLmNsYXNzTGlzdC5yZW1vdmUoJ2pzX3Jlc2V0VHJhbnNpdGlvbicpO1xuXHQgIFx0XHRhbmltYXRlZEJsb2NrLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWRhc2hvZmZzZXQnLCBkYXNoQXJyYXlTdW1OdW1iZXIpXHRcdFx0XG5cdCAgXHR9LCAxMClcblx0ICB9XG5cdH1cblxuXHR2YXIgZXZlbnRIYW5kbGVyID0gZnVuY3Rpb24oZXZlbnQpIHtcblx0XHQvLyBjb25zb2xlLmxvZygnZXZlbnQ6ICcpXG5cdFx0ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0Y3ljbGVPZmZzZXQoZXZlbnQsIHRoaXMsIHRoaXMuZGF0YXNldC5kYXNoQXJyYXlTdW0pXG5cdH1cblxuXHQvLyAtLS0tLS0tLS0tIEFjdGlvbiAtLS0tLS0tLVxuXG5cdGlmIChhbmltYXRlZERhc2hCbG9ja3MubGVuZ3RoKSB7XG5cblx0XHR2YXIgaW5pdCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBhbmltYXRlZERhc2hCbG9ja3MubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dmFyIHJlY3QgPSBhbmltYXRlZERhc2hCbG9ja3NbaV0ucXVlcnlTZWxlY3RvcigncmVjdC5hbmltYXRlZEJsb2NrJyk7XG5cdFx0XHRcdHZhciB0b3RhbExlbmd0aCA9IDAsIHJlc3VsdERhc2hBcnJheVN0cmluZyA9ICcnLCBkYXNoQXJyYXlTdW0gPSAwLCByYWRpdXMgPSAwO1xuXHRcdFx0XHRcblx0XHRcdFx0cmVjdC5yZW1vdmVFdmVudExpc3RlbmVyKFwidHJhbnNpdGlvbmVuZFwiLCBldmVudEhhbmRsZXIpO1xuXG5cdFx0XHRcdHRvdGFsTGVuZ3RoID0gZ2V0VG90YWxMZW5ndGgoIGFuaW1hdGVkRGFzaEJsb2Nrc1tpXSwgcmVjdCApO1xuXHRcdFx0XHRyYWRpdXMgPSB0b3RhbExlbmd0aC5yYWRpdXM7XG5cdFx0XHRcdC8vIGNvbnNvbGUubG9nKHRvdGFsTGVuZ3RoLmxlbmd0aClcblx0XHRcdFx0cmVzdWx0RGFzaEFycmF5U3RyaW5nID0gZ2V0RGFzaEFycmF5U3RyaW5nKHJlY3QsIHRvdGFsTGVuZ3RoLmxlbmd0aCk7XG5cdFx0XHRcdGRhc2hBcnJheVN1bSA9IE1hdGgucm91bmQoIG9wdGlvbnMubmV3U2hhZGVkU2VjdGlvbiArIG9wdGlvbnMubmV3VHJhbnNwYXJlbnRTZWN0aW9uICk7XG5cdFx0XHRcdGRhc2hBcnJheVN1bSA9IG9wdGlvbnMucmV2ZXJzZSA/IGRhc2hBcnJheVN1bSA6IGRhc2hBcnJheVN1bSAqIC0xO1xuXG5cdFx0XHRcdHJlY3Quc2V0QXR0cmlidXRlKCdzdHJva2Utd2lkdGgnLCBvcHRpb25zLmJvcmRlcldpZHRoKTtcblx0XHRcdFx0cmFkaXVzID8gcmVjdC5zZXRBdHRyaWJ1dGUoJ3J4JywgcmFkaXVzKSA6IG51bGw7XG5cdFx0XHRcdHJlY3Quc2V0QXR0cmlidXRlKCdzdHJva2UtZGFzaGFycmF5JywgcmVzdWx0RGFzaEFycmF5U3RyaW5nKTtcblx0XHRcdFx0cmVjdC5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS1kYXNob2Zmc2V0JywgZGFzaEFycmF5U3VtKjIpO1xuXHRcdFx0XHRyZWN0LnNldEF0dHJpYnV0ZSgnZGF0YS1kYXNoQXJyYXlTdW0nLCBkYXNoQXJyYXlTdW0qMik7XG5cblx0XHRcdFx0cmVjdC5hZGRFdmVudExpc3RlbmVyKFwidHJhbnNpdGlvbmVuZFwiLCBldmVudEhhbmRsZXIpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGluaXQoKTtcblxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuXHRcdHZhciB0aW1lciA9IG51bGw7XG5cdFx0d2luZG93Lm9ucmVzaXplID0gZnVuY3Rpb24oZXZlbnQpIHtcblx0XHQgIGlmICh0aW1lcikgeyBjbGVhclRpbWVvdXQodGltZXIpOyB9XG5cblx0XHQgIHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHQgICAgdGltZXIgPSBudWxsO1xuXG5cdFx0ICAgIC8vIHlvdXIgZXZlbnQgaGFuZGxpbmcgbG9naWMgaGVyZVxuXHRcdCAgICAvLyBjb25zb2xlLmxvZygncmVzaXplJylcblx0XHQgICAgaW5pdCgpXG5cblx0XHQgIH0sIDUwKTtcblx0XHR9O1xuXG5cdH1cblxufVxuXG4qL1xuICAvKi8vIGpRdWVyeSgnPGRpdiBjbGFzcz1cInF1YW50aXR5LW5hdlwiPjxkaXYgY2xhc3M9XCJxdWFudGl0eS1idXR0b24gcXVhbnRpdHktdXBcIj48L2Rpdj48ZGl2IGNsYXNzPVwicXVhbnRpdHktYnV0dG9uIHF1YW50aXR5LWRvd25cIj48L2Rpdj48L2Rpdj4nKS5pbnNlcnRBZnRlcignLnF1YW50aXR5IGlucHV0Jyk7XG5qUXVlcnkoJy5jdXN0b20tcXVhbnRpdHknKS5lYWNoKGZ1bmN0aW9uKCkge1xuICB2YXIgc3Bpbm5lciA9IGpRdWVyeSh0aGlzKSxcbiAgaW5wdXQgPSBzcGlubmVyLmZpbmQoJ2lucHV0W3R5cGU9XCJudW1iZXJcIl0nKSxcbiAgYnRuVXAgPSBzcGlubmVyLmZpbmQoJy5xdWFudGl0eS11cCcpLFxuICBidG5Eb3duID0gc3Bpbm5lci5maW5kKCcucXVhbnRpdHktZG93bicpLFxuICBtaW4gPSBpbnB1dC5hdHRyKCdtaW4nKSxcbiAgbWF4ID0gaW5wdXQuYXR0cignbWF4Jyk7XG5cbiAgYnRuVXAuY2xpY2soZnVuY3Rpb24oKSB7XG5cbiAgICB2YXIgb2xkVmFsdWUgPSBwYXJzZUZsb2F0KGlucHV0LnZhbCgpKTtcbiAgICBpZiAob2xkVmFsdWUgPj0gbWF4KSB7XG4gICAgICAgIHZhciBuZXdWYWwgPSBvbGRWYWx1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgbmV3VmFsID0gb2xkVmFsdWUgKyAxO1xuICAgIH1cblxuICAgIHNwaW5uZXIuZmluZChcImlucHV0XCIpLnZhbChuZXdWYWwpO1xuXG4gICAgc3Bpbm5lci5maW5kKFwiaW5wdXRcIikudHJpZ2dlcihcImNoYW5nZVwiKTtcblxuICB9KTtcblxuICBidG5Eb3duLmNsaWNrKGZ1bmN0aW9uKCkge1xuXG4gICAgdmFyIG9sZFZhbHVlID0gcGFyc2VGbG9hdChpbnB1dC52YWwoKSk7XG4gICAgaWYgKG9sZFZhbHVlIDw9IG1pbikge1xuICAgICAgICB2YXIgbmV3VmFsID0gb2xkVmFsdWU7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIG5ld1ZhbCA9IG9sZFZhbHVlIC0gMTtcbiAgICB9XG4gICAgc3Bpbm5lci5maW5kKFwiaW5wdXRcIikudmFsKG5ld1ZhbCk7XG4gICAgc3Bpbm5lci5maW5kKFwiaW5wdXRcIikudHJpZ2dlcihcImNoYW5nZVwiKTtcbiAgfSk7XG5cbn0pOyovXG4gIC8qZ2xvYi5BY2NvcmRpb25Nb2R1bGUgID0gKGZ1bmN0aW9uKCkge1xuXHQvLyBjb25zb2xlLmxvZygnQWNjb3JkaW9uTW9kdWxlIG9rJyk7XG5cdFxuXHRmdW5jdGlvbiB0b2dnbGVDb250ZW50KG9wdGlvbnMsIGJ1dHRvbiwgdGFyZ2V0QmxvY2ssIGFsbFRhcmdldEJsb2Nrcykge1xuXHRcdGxldCBzdWJNZW51UGFyZW50cyA9IGJ1dHRvbiA/IGZpbmRBbGxQYXJlbnRzKGJ1dHRvbiwgJ3N1Ym1lbnVXcmFwcGVyJykgOiBudWxsO1xuXHRcdGxldCB0YXJnZXRIZWlnaHQgPSB0YXJnZXRCbG9jayA/IHRhcmdldEJsb2NrLmZpcnN0RWxlbWVudENoaWxkLm9mZnNldEhlaWdodCA6IG51bGw7XG5cblx0XHQvLyBjb25zb2xlLmxvZyhzdWJNZW51UGFyZW50cylcblxuXHRcdGZ1bmN0aW9uIGZpbmRBbGxQYXJlbnRzKGVsZW1lbnQsIHNlYXJjaENsYXNzKSB7XG5cdFx0XHR2YXIgZmluZGVkID0gZmFsc2U7XG5cdFx0XHR2YXIgY3VycmVudEVsZW1lbnQgPSBlbGVtZW50LCBmaW5kaW5nRWxlbWVudHMgPSBbXTtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdHdoaWxlKCFmaW5kZWQpIHtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coY3VycmVudEVsZW1lbnQucGFyZW50RWxlbWVudClcblx0XHRcdFx0XHR2YXIgcGFyZW50ID0gY3VycmVudEVsZW1lbnQucGFyZW50RWxlbWVudDtcblxuXHRcdFx0XHRcdGlmICggcGFyZW50LmNsYXNzTGlzdC5jb250YWlucyhzZWFyY2hDbGFzcykgKSB7XG5cdFx0XHRcdFx0XHRmaW5kaW5nRWxlbWVudHMucHVzaChwYXJlbnQpO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAocGFyZW50LmNsYXNzTGlzdC5jb250YWlucygnbWFpblN1Ym1lbnVXcmFwcGVyJykpIHtcblx0XHRcdFx0XHRcdGZpbmRlZCA9IHRydWU7XG5cdFx0XHRcdFx0XHRmaW5kaW5nRWxlbWVudHMucHVzaChjdXJyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50KTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAocGFyZW50LmNsYXNzTGlzdC5jb250YWlucygnYWNjb3JkaW9uTWVudScpKSBicmVhaztcblx0XHRcdFx0XHRjdXJyZW50RWxlbWVudCA9IHBhcmVudDtcblx0XHRcdFx0fVx0XHRcdFx0XG5cdFx0XHR9IGNhdGNoKGVycm9yKSB7Y29uc29sZS5sb2coZXJyb3IpfVxuXG5cdFx0XHQvLyBjb25zb2xlLmxvZyhjdXJyZW50RWxlbWVudClcblx0XHRcdHJldHVybiBmaW5kaW5nRWxlbWVudHM7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gcmVzZXREcm9wRG93bih0YXJnZXRFbGVtZW50cykge1xuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB0YXJnZXRFbGVtZW50cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHR0YXJnZXRFbGVtZW50c1tpXS5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuXHRcdFx0XHR0YXJnZXRFbGVtZW50c1tpXS5zdHlsZS5oZWlnaHQgPSBcIlwiO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIGNsb3NlU2libGluZ3MoYnV0dG9uLCB0YXJnZXRFbGVtZW50cykge1xuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB0YXJnZXRFbGVtZW50cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRsZXQgYnV0dG9uID0gdGFyZ2V0RWxlbWVudHNbaV0ucGFyZW50RWxlbWVudFxuXHRcdFx0XHRpZiAoYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykgKSB7XG5cdFx0XHRcdFx0YnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuXHRcdFx0XHRcdHRhcmdldEVsZW1lbnRzW2ldLnN0eWxlLmhlaWdodCA9IFwiMHB4XCI7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gZHJvcERvd24oYnV0dG9uLCB0YXJnZXRFbGVtZW50LCBzdWJNZW51UGFyZW50cykge1xuXHRcdFx0aWYgKCBidXR0b24uY2hlY2tlZCB8fCBidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSApIHtcblx0XHRcdFx0aWYgKHN1Yk1lbnVQYXJlbnRzLmxlbmd0aCkge1xuXHRcdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgc3ViTWVudVBhcmVudHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdHN1Yk1lbnVQYXJlbnRzW2ldLnN0eWxlLmhlaWdodCA9IHN1Yk1lbnVQYXJlbnRzW2ldLm9mZnNldEhlaWdodCArIHRhcmdldEhlaWdodCArICdweCc7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdHRhcmdldEVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gdGFyZ2V0SGVpZ2h0ICsgJ3B4J1xuXHRcdFx0fSBlbHNlIHtcdFx0XHQgXG5cdFx0XHRcdHRhcmdldEVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gXCIwcHhcIjtcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBzdWJNZW51UGFyZW50cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdHN1Yk1lbnVQYXJlbnRzW2ldLnN0eWxlLmhlaWdodCA9ICBzdWJNZW51UGFyZW50c1tpXS5vZmZzZXRIZWlnaHQgLSB0YXJnZXRIZWlnaHQgKyAncHgnO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cblx0XHRzd2l0Y2ggKG9wdGlvbnMgIHx8ICdkZWZhdWx0Jykge1xuXG5cdFx0XHRjYXNlICd3aXRoU2libGluZ3MnOiBcblx0XHRcdFx0Y2xvc2VTaWJsaW5ncyhidXR0b24sIGFsbFRhcmdldEJsb2Nrcyk7XG5cdFx0XHRcdGRyb3BEb3duKGJ1dHRvbiwgdGFyZ2V0QmxvY2ssIHN1Yk1lbnVQYXJlbnRzKTtcblx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlICd3aXRob3V0U2libGluZ3MnOiBkcm9wRG93bihidXR0b24sIHRhcmdldEJsb2NrLCBzdWJNZW51UGFyZW50cyk7IGJyZWFrO1xuXG5cdFx0XHRjYXNlICdyZXNldERyb3BEb3duJzogcmVzZXREcm9wRG93bihhbGxUYXJnZXRCbG9ja3MpOyBicmVhaztcblxuXHRcdFx0ZGVmYXVsdDogY29uc29sZS5lcnJvcignbm8gY29ycmVjdCBvcHRpb24gdHlwZWQgaW4gdG9nZ2xlQ29udGVudCBmdW5jdGlvbicpO1xuXG5cdFx0fVxuXG5cdH1cbiAgICBcblx0Ly8gLS0tLS1SZXNpemUgRXZlbnQtLS0tLS1cblx0Ly8gY29uc3QgbW9iaWxlRmlsdGVyTWVudUJsb2NrcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNmaWx0ZXJXcmFwcGVyIC5maWx0ZXItaXRlbSAuZmlsdGVyLWNvbnRlbnQtd3JhcHBlcicpO1xuXG5cdC8vIGxldCB0aW1lciA9IG51bGw7XG5cblx0Ly8gd2luZG93Lm9ucmVzaXplID0gZnVuY3Rpb24gKCkge1xuXHQvLyBcdGlmICh0aW1lcikge1xuXHQvLyBcdFx0Y2xlYXJUaW1lb3V0KHRpbWVyKTtcblx0Ly8gXHR9XG5cblx0Ly8gXHR0aW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdC8vIFx0XHR0aW1lciA9IG51bGw7XG5cbiAvLyAgICAgLy8gPT09PT09PUhhbmRsZXJzPT09PT09PVxuIC8vICAgICAgaWYgKG1vYmlsZUZpbHRlck1lbnVCbG9ja3MpIHtcbiAvLyAgICAgIFx0aWYgKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCA+IDk5MSkge1xuXHQvLyBcdFx0XHRcdHRvZ2dsZUNvbnRlbnQoXCJyZXNldERyb3BEb3duXCIsIG51bGwsIG51bGwsIG1vYmlsZUZpbHRlck1lbnVCbG9ja3MpO1xuXHQvLyBcdFx0XHR9XG4gLy8gICAgICB9XG4gLy8gICAgIH0sIDUwKTtcblx0Ly8gfTtcblxuXHRcbi8vIC0tLS0tLS0tLS0tLVxuXG5cdHJldHVybiB7XG5cdFx0dG9nZ2xlQ29udGVudDogdG9nZ2xlQ29udGVudCxcblx0fVxuXG59KSgpKi9cbiAgLypnbG9iLlRvZ2dsZUNvbnRlbnRNb2R1bGUgID0gKGZ1bmN0aW9uKCkge1xuXHQvLyBjb25zb2xlLmxvZygnVG9nZ2xlQ29udGVudE1vZHVsZSBvaycpO1xuXHQvLyBjb25zb2xlLnRpbWUoJ1RvZ2dsZUNvbnRlbnQgTW9kdWxlIGxvYWQnKTtcblxuXHRmdW5jdGlvbiB0b2dnbGVDb250ZW50KGJ1dHRvbkVsZW1lbnQsIGRhdGEpIHtcblx0XHRsZXQgYnV0dG9uID0gYnV0dG9uRWxlbWVudCxcblx0XHRcdFx0YnV0dG9uRGF0YSA9IGRhdGEuYnV0dG9uRGF0YSxcblx0XHRcdFx0dGFyZ2V0cyA9IGRhdGEudGFyZ2V0cyxcblx0XHRcdFx0dGhpc1RhcmdldCA9IGRhdGEudGhpc0NvbnRlbnQsXG5cdFx0XHRcdHRhcmdldEJ1dHRvbnMgPSBkYXRhLnRhcmdldEJ1dHRvbnMsXG5cdFx0XHRcdHRhcmdldHNSZXZlcnNlID0gZGF0YS50YXJnZXRzUmV2ZXJzZTtcblxuXHRcdFx0Ly8gY29uc29sZS5sb2coZGF0YSlcblxuXHRcdFxuXHRcdC8vIC0tLS0tLU1ldGhvZHMtLS0tLS0tLVxuXG5cdFx0ZnVuY3Rpb24gZHJvcERvd24oYnV0dG9uLCB0YXJnZXRCbG9jaywgYWN0aW9uLCBidXR0b25zRWxlbWVudHMpIHtcblx0XHRcdGlmIChhY3Rpb24gPT09ICdzaG93JyApIHtcblx0XHRcdFx0YnV0dG9uLmNoZWNrZWQgfHwgYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykgPyBcblx0XHRcdFx0dGFyZ2V0QmxvY2suc3R5bGUuaGVpZ2h0ID0gdGFyZ2V0QmxvY2suZmlyc3RFbGVtZW50Q2hpbGQub2Zmc2V0SGVpZ2h0ICsgJ3B4JyA6XG5cdFx0XHRcdHRhcmdldEJsb2NrLnN0eWxlLmhlaWdodCA9IFwiMHB4XCI7XG5cdFx0XHR9XHRlbHNlIGlmIChhY3Rpb24gPT09ICdoaWRlUmV2ZXJzZScpIHtcblx0XHRcdFx0YnV0dG9uLmNoZWNrZWQgfHwgYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykgPyBcblx0XHRcdFx0dGFyZ2V0QmxvY2suc3R5bGUuaGVpZ2h0ID0gXCIwcHhcIiA6XG5cdFx0XHRcdHRhcmdldEJsb2NrLnN0eWxlLmhlaWdodCA9IHRhcmdldEJsb2NrLmZpcnN0RWxlbWVudENoaWxkLm9mZnNldEhlaWdodCArICdweCc7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0YXJnZXRCbG9jay5zdHlsZS5oZWlnaHQgPSBcIjBweFwiO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIHNob3dIaWRlKGJ1dHRvbiwgdGFyZ2V0QmxvY2ssIGFjdGlvbiwgY3NzU2hvd0NsYXNzLCBjc3NIaWRlQ2xhc3MpIHtcblx0XHRcdGlmIChhY3Rpb24gPT09ICdzaG93JyApIHtcblx0XHRcdFx0YnV0dG9uLmNoZWNrZWQgfHwgYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykgPyBcblx0XHRcdFx0XHR0YXJnZXRCbG9jay5jbGFzc0xpc3QuYWRkKGNzc1Nob3dDbGFzcykgOiB0YXJnZXRCbG9jay5jbGFzc0xpc3QucmVtb3ZlKGNzc1Nob3dDbGFzcyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRidXR0b24uY2hlY2tlZCB8fCBidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSA/XG5cdFx0XHRcdFx0dGFyZ2V0QmxvY2suY2xhc3NMaXN0LmFkZChjc3NIaWRlQ2xhc3MpIDogdGFyZ2V0QmxvY2suY2xhc3NMaXN0LnJlbW92ZShjc3NIaWRlQ2xhc3MpO1xuXHRcdFx0fVx0XG5cdFx0fVxuXG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdFx0ZnVuY3Rpb24gY2xlYW5CdXR0b25zKHRhcmdldEVsZW1lbnRzKSB7XG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHRhcmdldEVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdHRhcmdldEVsZW1lbnRzW2ldLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykgPyBcblx0XHRcdFx0XHR0YXJnZXRFbGVtZW50c1tpXS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKSA6IG51bGw7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gdG9nZ2xlKHRhcmdldEJsb2NrcywgYWN0aW9uKSB7XG5cdFx0XHQvLyBjb25zb2xlLmxvZyh0YXJnZXRCbG9ja3MpXG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHRhcmdldEJsb2Nrcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRzd2l0Y2ggKGJ1dHRvbkRhdGEubWVudVR5cGUgfHwgJ2RlZmF1bHQnKSB7XG5cdFx0XHRcdFx0Y2FzZSAnc2NhbGUnOiBzaG93SGlkZSggYnV0dG9uLCB0YXJnZXRCbG9ja3NbaV0sIGFjdGlvbiwgJ2pzX3Nob3dTY2FsZScsICdqc19oaWRlU2NhbGUnICk7IGJyZWFrO1xuXHRcdFx0XHRcdGNhc2UgJ2Ryb3AtZG93bic6IGRyb3BEb3duKCBidXR0b24sIHRhcmdldEJsb2Nrc1tpXSwgYWN0aW9uICk7IGJyZWFrO1xuXHRcdFx0XHRcdGNhc2UgJ2Ryb3AtbGVmdCc6IHNob3dIaWRlKCBidXR0b24sIHRhcmdldEJsb2Nrc1tpXSwgYWN0aW9uLCAnanNfc2hvd1NsaWRlX2xlZnQnLCAnanNfaGlkZVNsaWRlX2xlZnQnKTsgYnJlYWs7XG5cdFx0XHRcdFx0Y2FzZSAnZHJvcC1yaWdodCc6IHNob3dIaWRlKCBidXR0b24sIHRhcmdldEJsb2Nrc1tpXSwgYWN0aW9uLCAnanNfc2hvd1NsaWRlX3JpZ2h0JywgJ2pzX2hpZGVTbGlkZV9yaWdodCcpOyBicmVhaztcblx0XHRcdFx0XHRjYXNlICdzaG93LWhpZGUnOiBzaG93SGlkZSggYnV0dG9uLCB0YXJnZXRCbG9ja3NbaV0sIGFjdGlvbiwgJ2pzX3Nob3cnLCAnanNfaGlkZScgKTsgYnJlYWs7XG5cblx0XHRcdFx0XHRkZWZhdWx0OiBjb25zb2xlLmVycm9yKCdubyBjb3JyZWN0IFwiZGF0YS1tZW51LXR5cGVcIiBhdHRyaWJ1dGUgaXMgc2V0IHRvIHRoZSBidXR0b24gZWxlbWVudCBpbiBIVE1MIScpO1xuXHRcdFx0XHR9XHRcdFx0XHRcdFx0XG5cdFx0XHR9ICAgICAgXG5cdFx0fVxuXG5cblx0XHRzd2l0Y2ggKGJ1dHRvbkRhdGEuYnV0dG9uVHlwZSB8fCAnZGVmYXVsdCcpIHtcblx0XHRcdGNhc2UgJ2NoZWNrYm94Jzpcblx0XHRcdGNhc2UgJ2J1dHRvbic6XG5cdFx0XHRjYXNlICdtZW51QnV0dG9uJzpcblx0XHRcdFx0XHR0b2dnbGUodGFyZ2V0cywgJ3Nob3cnKTtcblx0XHRcdFx0XHR0b2dnbGUodGFyZ2V0c1JldmVyc2UsICdoaWRlUmV2ZXJzZScpO1x0XHRcdFx0XHRcblx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlICdhY2NvcmRpb24nOiBcblx0XHRcdFx0aWYgKGJ1dHRvbkRhdGEuc2libGluZ3MgPT0gJ3llcycpIHtcblx0XHRcdFx0XHR0b2dnbGUodGFyZ2V0c1JldmVyc2UsICdoaWRlJyk7XG5cdFx0XHRcdFx0Y2xlYW5CdXR0b25zKHRhcmdldEJ1dHRvbnMpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHRvZ2dsZSh0aGlzVGFyZ2V0LCAnc2hvdycpO1xuXHRcdFx0YnJlYWs7XG5cblx0XHRcdGRlZmF1bHQ6IGNvbnNvbGUuZXJyb3IoJ25vIGNvcnJlY3QgXCJkYXRhLWJ1dHRvbi10eXBlXCIgYXR0cmlidXRlIGlzIHNldCB0byB0aGUgYnV0dG9uIGVsZW1lbnQgaW4gSFRNTCEnKTtcblx0XHR9XG5cblx0fVxuXG5cdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0ZnVuY3Rpb24gdGFyZ2V0c0ZvckFjdGlvbihidXR0b25FbGVtZW50LCBidXR0b25EYXRhKSB7XG5cdFx0bGV0IHRhcmdldHNGb3JBY3Rpb25JZCA9IGJ1dHRvbkRhdGEudGFyZ2V0ID8gYnV0dG9uRGF0YS50YXJnZXQuc3BsaXQoJyAnKSA6IG51bGwsXG5cdFx0IFx0XHR0YXJnZXRzRm9yQWN0aW9uID0gW107XG5cblx0XHRpZiAodGFyZ2V0c0ZvckFjdGlvbklkKSB7XG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHRhcmdldHNGb3JBY3Rpb25JZC5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHR0YXJnZXRzRm9yQWN0aW9uLnB1c2goIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhcmdldHNGb3JBY3Rpb25JZFtpXSkgKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gdGFyZ2V0c0ZvckFjdGlvbjtcblx0fVxuXG5cdGZ1bmN0aW9uIHRhcmdldHNGb3JSZXZlcnNlQWN0aW9uKGJ1dHRvbkVsZW1lbnQsIGJ1dHRvbkRhdGEpIHtcblx0XHRsZXRcdHRhcmdldHNGb3JSZXZlcnNlQWN0aW9uSWQgPSBidXR0b25EYXRhLnRhcmdldFJldmVyc2UgPyBidXR0b25EYXRhLnRhcmdldFJldmVyc2Uuc3BsaXQoJyAnKSA6IG51bGwsXG5cdFx0XHRcdHRhcmdldHNGb3JBY3Rpb25Hcm91cCA9IGJ1dHRvbkRhdGEuZ3JvdXAgPyBidXR0b25EYXRhLmdyb3VwIDogbnVsbCxcblx0XHRcdFx0dGFyZ2V0c0ZvclJldmVyc2VBY3Rpb24gPSBbXTtcdFxuXG5cdFx0aWYgKHRhcmdldHNGb3JSZXZlcnNlQWN0aW9uSWQpIHtcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdGFyZ2V0c0ZvclJldmVyc2VBY3Rpb25JZC5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHR0YXJnZXRzRm9yUmV2ZXJzZUFjdGlvbi5wdXNoKCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YXJnZXRzRm9yUmV2ZXJzZUFjdGlvbklkW2ldKSApO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZiAodGFyZ2V0c0ZvckFjdGlvbkdyb3VwKSB7XG5cdFx0XHR0YXJnZXRzRm9yUmV2ZXJzZUFjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUodGFyZ2V0c0ZvckFjdGlvbkdyb3VwKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGFyZ2V0c0ZvclJldmVyc2VBY3Rpb247XG5cdH1cblxuXHRmdW5jdGlvbiB0aGlzQ29udGVudFRhcmdldChidXR0b25FbGVtZW50LCBidXR0b25EYXRhKSB7XG5cdFx0bGV0IHRoaXNUYXJnZXQgPSBidXR0b25EYXRhLmdyb3VwID8gYnV0dG9uRWxlbWVudC5wYXJlbnRFbGVtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoYnV0dG9uRGF0YS5ncm91cCkgOiBudWxsO1xuXHRcdHJldHVybiB0aGlzVGFyZ2V0O1xuXHR9XG5cblx0ZnVuY3Rpb24gdGFyZ2V0c0ZvclJldmVyc2VBY3Rpb25CdXR0b25zKGJ1dHRvbkVsZW1lbnQsIGJ1dHRvbkRhdGEpIHtcblx0XHRsZXQgdGFyZ2V0QnV0dG9ucyA9IFtdO1xuXG5cdFx0aWYgKGJ1dHRvbkRhdGEuZ3JvdXApIHtcblx0XHRcdGxldCBidXR0b25zQWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNob3dCdXR0b25bZGF0YS1ncm91cD1cIicgKyBidXR0b25EYXRhLmdyb3VwICsgJ1wiXScgKTtcblxuXHRcdFx0aWYgKGJ1dHRvbnNBbGwpIHtcblx0XHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBidXR0b25zQWxsLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0YnV0dG9uc0FsbFtpXSA9PT0gYnV0dG9uRWxlbWVudCA/IG51bGwgOiB0YXJnZXRCdXR0b25zLnB1c2goYnV0dG9uc0FsbFtpXSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gdGFyZ2V0QnV0dG9ucztcdFxuXHR9XG5cblxuXHQvLyAtLS0tU2hvdyBDb250ZW50IEFjdGlvbnMgLS0tLS0tLS0tXG5cdCQoJ2JvZHknKS5vbignY2xpY2snLCAnLnNob3dCdXR0b24nLCBmdW5jdGlvbigpIHtcblx0XHQvLyBjb25zb2xlLnRpbWUoJ2NsaWNrIHRvZ2dsZSB3b3JraW5nIHRpbWUnKTtcblxuXHRcdGxldCB0YXJnZXRDb250ZW50RGF0YSA9IHt9O1xuXG5cblx0XHQvLyAtLS0tLSB0YXJnZXRDb250ZW50RGF0YSBjb25zdHJ1Y3Rvci0tLS0tLVxuXHRcdGlmICh0aGlzKSB7XG5cdFx0XHRsZXQgYnV0dG9uRGF0YSA9IHRoaXMuZGF0YXNldDtcblxuXHRcdFx0Ly8gY29uc29sZS5sb2coYnV0dG9uRGF0YSlcblx0XHRcdHRhcmdldENvbnRlbnREYXRhID0ge307XG5cdFx0XHR0YXJnZXRDb250ZW50RGF0YS5idXR0b25EYXRhID0gYnV0dG9uRGF0YTtcblx0XHRcdHRhcmdldENvbnRlbnREYXRhLnRhcmdldHMgPSB0YXJnZXRzRm9yQWN0aW9uKHRoaXMsIGJ1dHRvbkRhdGEgKTtcblx0XHRcdHRhcmdldENvbnRlbnREYXRhLnRhcmdldHNSZXZlcnNlID0gdGFyZ2V0c0ZvclJldmVyc2VBY3Rpb24odGhpcywgYnV0dG9uRGF0YSApO1xuXG5cdFx0XHRpZiAoYnV0dG9uRGF0YS5idXR0b25UeXBlID09PSBcImFjY29yZGlvblwiKSB7XG5cdFx0XHRcdHRhcmdldENvbnRlbnREYXRhLnRoaXNDb250ZW50ID0gdGhpc0NvbnRlbnRUYXJnZXQodGhpcywgYnV0dG9uRGF0YSk7XG5cdFx0XHRcdHRhcmdldENvbnRlbnREYXRhLnRhcmdldEJ1dHRvbnMgPSB0YXJnZXRzRm9yUmV2ZXJzZUFjdGlvbkJ1dHRvbnModGhpcywgYnV0dG9uRGF0YSk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIC0tLS0tLS0tQWN0aW9ucy9FdmVudHMtLS0tLS0tLVxuXG5cdFx0XHRpZiAoYnV0dG9uRGF0YS5idXR0b25UeXBlID09PSBcIm1lbnVCdXR0b25cIikge1xuXHRcdFx0XHRnbG9iRnVuYy50b2dnbGVCdXR0b25Db250ZW50KHRoaXMpO1xuXHRcdFx0XHR0aGlzLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykgPyBcblx0XHRcdFx0XHRnbG9iRnVuYy5zaG93T3ZlcmxheShcIm1lbnVcIiwgZ2xvYi5wYWdlT3ZlcmxheSkgOiBcblx0XHRcdFx0XHRnbG9iRnVuYy5oaWRlT3ZlcmxheShcIm1lbnVcIiwgZ2xvYi5wYWdlT3ZlcmxheSk7XG5cblx0XHRcdFx0dG9nZ2xlQ29udGVudCh0aGlzLCB0YXJnZXRDb250ZW50RGF0YSk7XG5cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGdsb2JGdW5jLnRvZ2dsZUJ1dHRvbkNvbnRlbnQodGhpcyk7XG5cdFx0XHRcdHRvZ2dsZUNvbnRlbnQodGhpcywgdGFyZ2V0Q29udGVudERhdGEpO1x0XHRcdFx0XG5cdFx0XHR9XG5cblx0XHR9XG5cdFx0Ly8gY29uc29sZS50aW1lRW5kKCdjbGljayB0b2dnbGUgd29ya2luZyB0aW1lJyk7XG5cdFx0XHRcblx0fSk7XG5cblxufSkoKTsqL1xuICAvKmdsb2IuU3dpdGNoVGFic01vZHVsZSAgPSAoZnVuY3Rpb24oKSB7XG5cblx0Y29uc3QgZGVmYXVsdFRhYnNCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRhYnNOYXYgLnRhYkJ1dHRvbicpLFxuXHRkZWZhdWx0VGFic0Jsb2Nrc0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50b2dnbGVCbG9ja3MtbGlzdCcpLFxuXHRkZWZhdWx0VGFic0Jsb2Nrc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudG9nZ2xlQmxvY2snKTtcblxuXG5cdGZ1bmN0aW9uIHN3aXRjaFRhYnModGFiQnV0dG9uLCB0YWJzQmxvY2tzLCB0YWJCdXR0b25zKSB7XG5cdFx0bGV0IHRhcmdldCA9IHRhYkJ1dHRvbi5kYXRhc2V0LnRhcmdldDtcblxuXHRcdGlmICggIXRhYkJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpICkge1xuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB0YWJzQmxvY2tzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdHRhYkJ1dHRvbnNbaV0uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG5cdFx0XHRcdHRhYnNCbG9ja3NbaV0uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG5cblx0XHRcdFx0aWYgKHRhcmdldCA9PT0gdGFic0Jsb2Nrc1tpXS5pZCkge1xuXHRcdFx0XHRcdHRhYkJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsgXG5cdFx0XHRcdFx0dGFic0Jsb2Nrc1tpXS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsgXG5cdFx0XHRcdH0gXG5cblx0XHRcdH1cblx0XHR9XG5cdH1cblxuICAvLyAtLS1ldmVudHMtLS1cblxuICAkKCcudGFic05hdicpLm9uKCdjbGljaycsICcudGFiQnV0dG9uJywgZnVuY3Rpb24oKSB7XG4gIFx0XHR2YXIgdGFic0dyb3VwID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSh0aGlzLmRhdGFzZXQudGFic0dyb3VwKVxuICBcdFx0dmFyIHRhYkJ1dHRvbnMgPSB0aGlzLnBhcmVudEVsZW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgndGFiQnV0dG9uJylcbiAgXHRcdHZhciB0YWJzQmxvY2tzQ29udGFpbmVyID0gdGhpcy5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSh0aGlzLmRhdGFzZXQudGFic0NvbnRhaW5lcilbMF1cblxuICBcdFx0Ly8gY29uc29sZS5sb2codGFiQnV0dG9ucylcbiAgXHRcdC8vIGNvbnNvbGUubG9nKHRhYnNCbG9ja3NDb250YWluZXIpXG4gIFx0XHRpZiAodGFic0dyb3VwLmxlbmd0aCkge1x0c3dpdGNoVGFicyh0aGlzLCB0YWJzR3JvdXAsIHRhYkJ1dHRvbnMpO31cbiAgXHRcdGVsc2UgeyBzd2l0Y2hUYWJzKHRoaXMsIGRlZmF1bHRUYWJzQmxvY2tzTGlzdCwgdGFiQnV0dG9ucyk7XHR9XG5cbiAgXHRcdGlmICh0YWJzQmxvY2tzQ29udGFpbmVyKSB7Z2xvYkZ1bmMuYW5pbWF0ZUJsb2NrKHRhYnNCbG9ja3NDb250YWluZXIpO31cbiAgXHRcdGVsc2Uge2dsb2JGdW5jLmFuaW1hdGVCbG9jayhkZWZhdWx0VGFic0Jsb2Nrc0NvbnRhaW5lcik7fVx0ICBcdFx0XG4gIH0pXG5cblxufSkoKTsqL1xuICAvKmdsb2IuVGV4dExpbWl0TW9kdWxlICA9IChmdW5jdGlvbigpIHtcblx0Y29uc29sZS5sb2coJ1RleHRMaW1pdE1vZHVsZSBvaycpO1xuXG5cdGZ1bmN0aW9uIHNsaWNlVGV4dChzbGljaW5nQmxvY2tzLCBtYXhMZW5ndGgpIHtcblx0XHRpZiAoc2xpY2luZ0Jsb2Nrcykge1xuXG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHNsaWNpbmdCbG9ja3MubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0bGV0IGN1cnJlbnRUZXh0ID0gc2xpY2luZ0Jsb2Nrc1tpXS5pbm5lckhUTUw7XG5cblx0XHRcdFx0aWYgKGN1cnJlbnRUZXh0Lmxlbmd0aCA+IG1heExlbmd0aCkge1xuXHRcdFx0XHRcdHNsaWNpbmdCbG9ja3NbaV0uaW5uZXJIVE1MID0gY3VycmVudFRleHQuc2xpY2UoMCwgbWF4TGVuZ3RoKSArICcgLi4uJztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0fVxuXHR9XG5cdFxuXHRyZXR1cm4ge1xuXHRcdHNsaWNlVGV4dDogc2xpY2VUZXh0LFxuXHR9XG5cbn0pKCk7Ki9cbiAgLypnbG9iLlN0aWNreUJsb2NrTW9kdWxlID0gKGZ1bmN0aW9uKCkge1xuXG4gIHZhciB0YXJnZXQ7XG4gIHZhciByZWxhdGl2ZTtcbiAgdmFyIGlzQWN0aXZlID0gZmFsc2U7XG5cbiAgZnVuY3Rpb24gdG9TdGljayh0YXJnZXRCbG9jaywgcmVsYXRpdmVCbG9jaykge1xuICAgIHRhcmdldCA9IHRhcmdldEJsb2NrO1xuICAgIHJlbGF0aXZlID0gcmVsYXRpdmVCbG9jaztcbiAgICBpc0FjdGl2ZSA9IHRydWU7XG4gICAgLy8gY2woJ2FjdGl2YXRlICcsIGlzQWN0aXZlKVxuXG4gICAgdG9TY3JvbGwoaXNBY3RpdmUpXG4gIH1cblxuICBmdW5jdGlvbiB1blN0aWNrKCkge1xuICAgIGlzQWN0aXZlID0gZmFsc2U7XG4gICAgLy8gY2woJ2RlYWN0aXZhdGUnKVxuICAgIHRvU2Nyb2xsKGlzQWN0aXZlKSAgICBcbiAgfVxuICBcbiAgZnVuY3Rpb24gY2hlY2tQb3NpdGlvbih0YXJnZXRCbG9jaywgcmVsYXRpdmVCbG9jaykge1xuICAgIGlmICggIWdsb2JGdW5jLmlzVmlzaWJsZShyZWxhdGl2ZUJsb2NrLCAndG9wQm9yZGVyJykgKSB7XG5cbiAgICAgIGlmICggIXRhcmdldEJsb2NrLmNsYXNzTGlzdC5jb250YWlucygnanNfZml4ZWRfbmF2JykgKSB7XG4gICAgICAgIHRhcmdldEJsb2NrLnN0eWxlLndpZHRoID0gdGFyZ2V0QmxvY2sub2Zmc2V0V2lkdGggKyAncHgnO1xuICAgICAgICB0YXJnZXRCbG9jay5jbGFzc0xpc3QuYWRkKCdqc19maXhlZF9uYXYnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGdsb2JGdW5jLmdldENvb3Jkc09uU2NyZWVuKHRhcmdldEJsb2NrKS5ib3R0b20gPj0gZ2xvYkZ1bmMuZ2V0Q29vcmRzT25TY3JlZW4ocmVsYXRpdmVCbG9jaykuYm90dG9tKSB7XG4gICAgICAgIHRhcmdldEJsb2NrLmNsYXNzTGlzdC5hZGQoJ2pzX2Fic29sdXRlX25hdicpO1xuICAgICAgICB0YXJnZXRCbG9jay5jbGFzc0xpc3QucmVtb3ZlKCdqc19maXhlZF9uYXYnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCB0YXJnZXRCbG9jay5jbGFzc0xpc3QuY29udGFpbnMoJ2pzX2Fic29sdXRlX25hdicpICkge1xuICAgICAgICBpZiAoZ2xvYkZ1bmMuaXNWaXNpYmxlKHRhcmdldEJsb2NrLCBcInRvcEJvcmRlclwiKSkge1xuICAgICAgICAgIHRhcmdldEJsb2NrLmNsYXNzTGlzdC5yZW1vdmUoJ2pzX2Fic29sdXRlX25hdicpO1xuICAgICAgICAgIHRhcmdldEJsb2NrLmNsYXNzTGlzdC5hZGQoJ2pzX2ZpeGVkX25hdicpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKCB0YXJnZXRCbG9jay5jbGFzc0xpc3QuY29udGFpbnMoJ2pzX2ZpeGVkX25hdicpICkge1xuICAgICAgICB0YXJnZXRCbG9jay5zdHlsZS53aWR0aCA9ICcnO1xuICAgICAgICB0YXJnZXRCbG9jay5jbGFzc0xpc3QucmVtb3ZlKCdqc19maXhlZF9uYXYnKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiB0b1Njcm9sbChzdGF0dXMpIHtcbiAgICBpZiAoc3RhdHVzKSB7XG4gICAgICAkKHdpbmRvdykuc2Nyb2xsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRhcmdldCAmJiByZWxhdGl2ZSkge1xuICAgICAgICAgIGNoZWNrUG9zaXRpb24odGFyZ2V0LCByZWxhdGl2ZSlcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9XG4gIH1cbiAgXG4gIFxuXG4gIHJldHVybiB7XG4gICAgdG9TdGljazogdG9TdGljayxcbiAgICB1blN0aWNrOiB1blN0aWNrLFxuICB9XG5cbn0pKCkqL1xuICAvKmdsb2IuTGF6eUxvYWRNb2R1bGUgID0gKGZ1bmN0aW9uKCkge1xuXHR2YXIgbGF6eUJsb2NrcyA9IFtdXG5cblx0ZnVuY3Rpb24gaW5pdChzZWxlY3Rvcikge1xuXHRcdHNldExhenkoc2VsZWN0b3IpO1xuXHRcdGxhenlMb2FkKGxhenlCbG9ja3MpO1xuXHR9XG5cblx0ZnVuY3Rpb24gc2V0TGF6eShjbGFzc1NlbGVjdG9yKXtcblx0XHQvLyBjb25zb2xlLmxvZyhzZWxlY3Rvcilcblx0XHRsYXp5QmxvY2tzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShjbGFzc1NlbGVjdG9yKTtcblx0XHRcdC8vIGNsKGxhenlCbG9ja3MubGVuZ3RoKVxuXHRcdGlmIChsYXp5QmxvY2tzLmxlbmd0aCkge1xuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBsYXp5QmxvY2tzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGlmICghbGF6eUJsb2Nrc1tpXS5nZXRBdHRyaWJ1dGUoJ2hhcy1wcmVsb2FkZXInKSkge1xuXHRcdFx0XHRcdHZhciBwcmVsb2FkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHRcdFx0XHRwcmVsb2FkZXIuY2xhc3NOYW1lID0gJ2ltZ1ByZWxvYWRlcic7XG5cdFx0XHRcdFx0cHJlbG9hZGVyLmlubmVySFRNTCA9ICc8aW1nIHNyYz1cIi9pbWcvaWNvbnMvbGF6eV9wcmVsb2FkZXIuanBnXCIgYWx0PVwibG9hZGVyXCI+J1xuXHRcdFx0XHRcdGxhenlCbG9ja3NbaV0ucGFyZW50RWxlbWVudC5hcHBlbmRDaGlsZChwcmVsb2FkZXIpO1xuXHRcdFx0XHRcdGxhenlCbG9ja3NbaV0uc2V0QXR0cmlidXRlKCdoYXMtcHJlbG9hZGVyJywgdHJ1ZSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG4gICAgLy8gY29uc29sZS5sb2coJ0ZvdW5kICcgKyBsYXp5QmxvY2tzLmxlbmd0aCArICcgbGF6eSBpbWFnZXMnKTtcblx0fVxuXG5cdGZ1bmN0aW9uIGxvYWRlZChlbCkge1xuICAgIC8vIGVsLnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1zcmMnKTtcbiAgICAvLyBlbC5jbGFzc0xpc3QucmVtb3ZlKCdsYXp5QmxvY2snKTtcblx0XHRsZXQgbG9hZGVyID0gZWwucGFyZW50RWxlbWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdpbWdQcmVsb2FkZXInKVswXTtcblx0XHRpZiAobG9hZGVyKSAkKGxvYWRlcikuZmFkZU91dCgpO1xuXHRcdC8vIGNsZWFuTGF6eSgpXG5cdH1cblxuXHRmdW5jdGlvbiBsb2FkSW1hZ2UoZWxlbWVudCkge1xuXHRcdGlmKCBpc0luVmlld3BvcnQoZWxlbWVudCkgKSB7XG4gICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnaXNMb2FkaW5nJywgdHJ1ZSk7XG5cblx0XHRcdGlmIChlbGVtZW50LnRhZ05hbWUgIT09ICdJTUcnKSB7XG5cdFx0XHRcdHZhciBpbWcgPSBuZXcgSW1hZ2UoKTtcblx0XHRcdFx0dmFyIHNyY0RhdGEgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1zcmMnKTtcblx0XHRcdFx0aWYgKHNyY0RhdGEpIHsgXG5cdFx0XHRcdFx0aW1nLm9ubG9hZCA9IGZ1bmN0aW9uKCl7XG5cdFx0XHRcdFx0ICBlbGVtZW50LnN0eWxlLmJhY2tncm91bmRJbWFnZSA9ICd1cmwoJyArIGltZy5nZXRBdHRyaWJ1dGUoJ3NyYycpICsgJyknO1xuXHRcdFx0XHRcdCAgbG9hZGVkKGVsZW1lbnQpO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvLyBlbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1zcmMnKTtcblx0XHRcdFx0XHRpbWcuc2V0QXR0cmlidXRlKCdzcmMnLCBzcmNEYXRhKTsgXG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHZhciBzcmNEYXRhID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtc3JjJyk7XG5cdFx0XHRcdGlmIChzcmNEYXRhKXtcblx0XHRcdFx0XHRlbGVtZW50Lm9ubG9hZCA9IGZ1bmN0aW9uKCl7XG5cdFx0XHRcdFx0ICBsb2FkZWQoZWxlbWVudCk7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdGVsZW1lbnQuc2V0QXR0cmlidXRlKCdzcmMnLCBzcmNEYXRhKTsgXG5cdFx0XHRcdFx0Ly8gZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtc3JjJyk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRmdW5jdGlvbiBsYXp5TG9hZChsYXp5QmxvY2tzKSB7XG5cdFx0Ly8gaWYgKGxhenlCbG9ja3MubGVuZ3RoKSB7XG5cdFx0XHRsZXQgbGF6eUIgPSBsYXp5QmxvY2tzO1xuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBsYXp5Qi5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHR2YXIgaXNMb2FkaW5nID0gbGF6eUJbaV0uZ2V0QXR0cmlidXRlKCdpc0xvYWRpbmcnKTtcblx0XHRcdFx0aWYgKCBpc0xvYWRpbmcgIT0gJ3RydWUnICkge1xuXHRcdFx0XHRcdGxvYWRJbWFnZShsYXp5QltpXSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y2xlYW5MYXp5KClcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0Ly8gY2xlYW5MYXp5KClcblx0XHQvLyB9XG5cdH1cblxuXHRmdW5jdGlvbiBjbGVhbkxhenkoKXtcblx0XHRpZiAobGF6eUJsb2Nrcy5sZW5ndGgpIHtcblx0XHRcdGxhenlCbG9ja3MgPSAgQXJyYXkucHJvdG90eXBlLmZpbHRlci5jYWxsKGxhenlCbG9ja3MsIGZ1bmN0aW9uKGwpeyByZXR1cm4gbC5nZXRBdHRyaWJ1dGUoJ2lzTG9hZGluZycpICE9ICd0cnVlJzt9KTtcblx0XHR9XG5cdCAgICAvLyBjbChsYXp5QmxvY2tzLmxlbmd0aClcblx0fVxuXG5cblx0ZnVuY3Rpb24gaXNJblZpZXdwb3J0KGVsKXtcbiAgICB2YXIgcmVjdCA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIFxuICAgIHJldHVybiAoXG4gICAgICAgIHJlY3QuYm90dG9tID49IDAgJiYgXG4gICAgICAgIC8vIHJlY3QucmlnaHQgPj0gMCAmJiBcbiAgICAgICAgcmVjdC50b3AgPD0gKHdpbmRvdy5pbm5lckhlaWdodCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0KVxuICAgICAgICAvLyByZWN0LmxlZnQgPD0gKHdpbmRvdy5pbm5lcldpZHRoIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aClcbiAgICApO1xuXHR9XG5cblx0dmFyIHRpbWVyID0gbnVsbDtcblx0JCh3aW5kb3cpLnNjcm9sbChmdW5jdGlvbiAoKSB7XG5cdFx0aWYgKHRpbWVyKSB7IGNsZWFyVGltZW91dCh0aW1lcik7IH1cblxuXHQgIHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICBcdHRpbWVyID0gbnVsbDtcblx0ICAgIFxuXHQgICAgLy8gc2V0TGF6eSgpO1xuXHQgICAgLy8gY2wobGF6eUJsb2Nrcy5sZW5ndGgpXG5cdCAgICBpZiAobGF6eUJsb2Nrcy5sZW5ndGgpIHsgbGF6eUxvYWQobGF6eUJsb2Nrcyk7IH1cblxuXHQgIH0sIDUwKTtcblx0fSlcblxuXHQvLyAtLS0tLS0tLS0tLS1cblxuXHRyZXR1cm4ge1xuXHQgIGluaXRMYXp5OiBpbml0LFxuXHQgIC8vIGxhenlMb2FkOiBsYXp5TG9hZCxcblx0fVxuXG5cbn0pKCk7Ki9cbiAgLypnbG9iLk9wZW5DbG9zZU1vZHVsZSAgPSAoZnVuY3Rpb24oKSB7XG5cdC8vIGNvbnNvbGUubG9nKCdPcGVuQ2xvc2VNb2R1bGUgb2snKTtcblx0Ly8gY29uc29sZS50aW1lKCdUb2dnbGVDb250ZW50IE1vZHVsZSBsb2FkJyk7XG5cblx0ZnVuY3Rpb24gaW5pdGlhdGUoYnV0dG9uRWxlbWVudCkge1xuXHRcdGxldCBidXR0b24gPSBidXR0b25FbGVtZW50LFxuXHRcdFx0XHRidXR0b25EYXRhID0gYnV0dG9uLmRhdGFzZXQsXG5cdFx0XHRcdHRhcmdldCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGJ1dHRvbkRhdGEudGFyZ2V0KSxcblx0XHRcdFx0Y29udHJvbENsYXNzID0gYnV0dG9uRGF0YS5jbGFzcztcblxuXHRcdC8vIC0tLS0tLU1ldGhvZHMtLS0tLS0tLVxuXHRcdGlmICh0YXJnZXQgJiYgY29udHJvbENsYXNzKSB7XG5cblx0XHRcdGlmIChidXR0b25EYXRhLmFjdGlvbikge1xuXHRcdFx0XHRpZiAoYnV0dG9uRGF0YS5hY3Rpb24gPT0gJ29wZW4nKSB7XG5cdFx0XHRcdFx0Z2xvYkZ1bmMudG9nZ2xlQnV0dG9uQ29udGVudChidXR0b24pO1xuXHRcdFx0XHRcdHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoY29udHJvbENsYXNzKSA/IG51bGwgOiB0YXJnZXQuY2xhc3NMaXN0LmFkZChjb250cm9sQ2xhc3MpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKGJ1dHRvbkRhdGEuYWN0aW9uID09ICdjbG9zZScpIHtcblx0XHRcdFx0XHR2YXIgdGhpc0dyb3VwT3BlbkJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcub3BlbkJ1dHRvbltkYXRhLXRhcmdldD1cIicgKyBidXR0b25EYXRhLnRhcmdldCArICdcIl0nICk7XG5cdFx0XHRcdFx0aWYgKHRoaXNHcm91cE9wZW5CdXR0b25zLmxlbmd0aCkge1xuXHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzR3JvdXBPcGVuQnV0dG9ucy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHR0aGlzR3JvdXBPcGVuQnV0dG9uc1tpXS5kYXRhc2V0LmFjdGlvbiA9PSAnb3BlbicgPyBnbG9iRnVuYy50b2dnbGVCdXR0b25Db250ZW50KHRoaXNHcm91cE9wZW5CdXR0b25zW2ldKSA6IG51bGw7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoY29udHJvbENsYXNzKSA/IHRhcmdldC5jbGFzc0xpc3QucmVtb3ZlKGNvbnRyb2xDbGFzcykgOiBudWxsO1xuXHRcdFx0XHR9XG5cdFx0XHR9XHRlbHNlIHsgXG5cdFx0XHRcdGdsb2JGdW5jLnRvZ2dsZUJ1dHRvbkNvbnRlbnQoYnV0dG9uKTtcblx0XHRcdFx0dGFyZ2V0LmNsYXNzTGlzdC50b2dnbGUoY29udHJvbENsYXNzKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdH1cdFx0XHRcblx0fVxuXG5cdC8vIC0tLS1TaG93IENvbnRlbnQgQWN0aW9ucyAtLS0tLS0tLS1cblx0JCgnYm9keScpLm9uKCdjbGljaycsICcub3BlbkJ1dHRvbicsIGZ1bmN0aW9uKCkge1xuXHRcdC8vIGNvbnNvbGUudGltZSgnY2xpY2sgdG9nZ2xlIHdvcmtpbmcgdGltZScpO1xuXG5cdFx0Ly8gLS0tLS0tLS1BY3Rpb25zL0V2ZW50cy0tLS0tLS0tXG5cblx0XHQvLyBnbG9iRnVuYy50b2dnbGVCdXR0b25Db250ZW50KHRoaXMpO1xuXHRcdGluaXRpYXRlKHRoaXMpO1x0XHRcdFx0XG5cdFx0Ly8gY29uc29sZS50aW1lRW5kKCdjbGljayB0b2dnbGUgd29ya2luZyB0aW1lJyk7XG5cdFx0XHRcblx0fSk7XG5cblxufSkoKTsqL1xuICAvKmdsb2IuUmFkaW9PcGVuQ2xvc2VNb2R1bGUgID0gKGZ1bmN0aW9uKCkge1xuXHQvLyBjb25zb2xlLmxvZygnT3BlbkNsb3NlTW9kdWxlIG9rJyk7XG5cdC8vIGNvbnNvbGUudGltZSgnVG9nZ2xlQ29udGVudCBNb2R1bGUgbG9hZCcpO1xuXG5cdGZ1bmN0aW9uIGhpZGVHcm91cChncm91cE5hbWUsIGNvbnRyb2xDbGFzcykge1xuXHRcdHZhciBncm91cEJsb2NrcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoZ3JvdXBOYW1lKTtcblxuXHRcdGlmIChncm91cEJsb2Nrcy5sZW5ndGgpIHtcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgZ3JvdXBCbG9ja3MubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0Z3JvdXBCbG9ja3NbaV0uY2xhc3NMaXN0LmNvbnRhaW5zKGNvbnRyb2xDbGFzcykgPyBncm91cEJsb2Nrc1tpXS5jbGFzc0xpc3QucmVtb3ZlKGNvbnRyb2xDbGFzcykgOiBudWxsO1xuXHRcdFx0fVxuXHRcdH1cblxuXHR9XG5cblx0ZnVuY3Rpb24gaW5pdGlhdGUoYnV0dG9ucykge1xuXHRcdHZhciBidXR0b24sXG5cdFx0XHRcdGJ1dHRvbkRhdGEsXG5cdFx0XHRcdHRhcmdldCxcblx0XHRcdFx0Y29udHJvbENsYXNzLFxuXHRcdFx0XHRpc0dyb3VwQ2hhbmdlLCBjdXJyZW50R3JvdXA7XG5cdFx0XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBidXR0b25zLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRidXR0b24gPSBidXR0b25zW2ldLFxuXHRcdFx0YnV0dG9uRGF0YSA9IGJ1dHRvbi5kYXRhc2V0LFxuXHRcdFx0dGFyZ2V0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYnV0dG9uRGF0YS50YXJnZXQpLFxuXHRcdFx0Y29udHJvbENsYXNzID0gYnV0dG9uRGF0YS5jbGFzcztcblx0XHRcdGlzR3JvdXBDaGFuZ2UgPSBjdXJyZW50R3JvdXAgPT09IGJ1dHRvbi5uYW1lID8gZmFsc2UgOiB0cnVlO1xuXHRcdFx0Y3VycmVudEdyb3VwID0gYnV0dG9uLm5hbWU7XG5cblx0XHRcdGlmIChpc0dyb3VwQ2hhbmdlKSB7XG5cdFx0XHRcdGhpZGVHcm91cChjdXJyZW50R3JvdXAsIGNvbnRyb2xDbGFzcylcblx0XHRcdH1cblxuXHRcdFx0aWYgKGJ1dHRvbi5jaGVja2VkICYmIHRhcmdldCkge1xuXHRcdFx0XHR0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKGNvbnRyb2xDbGFzcykgPyBudWxsIDogdGFyZ2V0LmNsYXNzTGlzdC5hZGQoY29udHJvbENsYXNzKTtcblx0XHRcdH1cdFx0XHRcblx0XHR9XG5cdFxuXHR9XG5cblx0dmFyIGFsbFJhZGlvQnV0dG9ucyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3JhZGlvQnV0dG9uJyk7XG5cblx0aWYgKGFsbFJhZGlvQnV0dG9ucy5sZW5ndGgpIHsgaW5pdGlhdGUoYWxsUmFkaW9CdXR0b25zKX1cblx0Ly8gLS0tLVNob3cgQ29udGVudCBBY3Rpb25zIC0tLS0tLS0tLVxuXHQkKCdib2R5Jykub24oJ2NsaWNrJywgJy5yYWRpb0J1dHRvbicsIGZ1bmN0aW9uKCkge1xuXHRcdC8vIGNvbnNvbGUudGltZSgnY2xpY2sgdG9nZ2xlIHdvcmtpbmcgdGltZScpO1xuXG5cdFx0Ly8gLS0tLS0tLS1BY3Rpb25zL0V2ZW50cy0tLS0tLS0tXG5cdFx0dmFyIGJ1dHRvbiA9IFtdO1xuXHRcdGJ1dHRvbi5wdXNoKHRoaXMpXG5cdFx0Ly8gZ2xvYkZ1bmMudG9nZ2xlQnV0dG9uQ29udGVudCh0aGlzKTtcblx0XHRpbml0aWF0ZShidXR0b24pO1x0XHRcdFx0XG5cdFx0Ly8gY29uc29sZS50aW1lRW5kKCdjbGljayB0b2dnbGUgd29ya2luZyB0aW1lJyk7XG5cdFx0XHRcblx0fSk7XG5cblxufSkoKTsqL1xuIFxuXHQvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cdGdsb2IubmF2TWVudVdyYXBwZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmF2TWVudVdyYXBwZXInKTtcblx0Z2xvYi5uYXZNZW51ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hdk1lbnUnKTtcblx0Z2xvYi5wYWdlT3ZlcmxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYWdlT3ZlcmxheScpO1xuXG5cdGlmICghJCgnYm9keScpKSB7Y29uc29sZS5sb2coJ2pRdWVyeSBFcnJvcicpfVxuXHQvLyBjb25zb2xlLmxvZyh0ZXN0KTtcblxuXHQvKiQoJy5tYWluSGVhZGVyJykub24oJ2NsaWNrJywgJy5tZW51LWJ1dHRvbicsIGZ1bmN0aW9uKGUpIHtcblx0XHRnbG9iRnVuYy50b2dnbGVCdXR0b25Db250ZW50KHRoaXMpXHRcblx0fSlcblxuXHQkKCcubWFpbkhlYWRlcicpLm9uKCdibHVyJywgJy5tZW51LWJ1dHRvbicsIGZ1bmN0aW9uKCkge1xuXHRcdC8vIGNvbnNvbGUubG9nKCdibHVyJylcblx0XHRpZiAodGhpcy5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpKSB7XG5cdFx0XHRnbG9iRnVuYy50b2dnbGVCdXR0b25Db250ZW50KHRoaXMpXHRcdFx0XG5cdFx0fVxuXHR9KSovXG5cblx0JCgnLmRyb3Bkb3duQnV0dG9uJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0Z2xvYkZ1bmMudG9nZ2xlQnV0dG9uQ29udGVudCh0aGlzKVxuXHRcdGdsb2JGdW5jLmRyb3BEb3duKHRoaXMsIGdsb2IubmF2TWVudVdyYXBwZXIpXG5cdH0pXG5cblxuICAvLyAtLS0tLS0tLS1Qb3B1cHMgQmxvY2stLS0tLS0tXG5cblx0JCgnYm9keScpLm9uKCdjbGljaycsICcuc2VhcmNoQnV0dG9uJywgZnVuY3Rpb24oKSB7XG4gIFx0Ly8gZS5wcmV2ZW50RGVmYXVsdCgpO1xuICBcdGxldCBtb2RhbCA9ICQoJyNwb3B1cFNlYXJjaCcpO1xuICBcdGlmICggbW9kYWwubGVuZ3RoICkge1xuICBcdFx0Z2xvYi5Qb3B1cE1vZHVsZS5vcGVuUG9wdXAobW9kYWwsIFwianNfb3BlblBvcHVwX3NlYXJjaFwiKTtcbiAgXHR9XG4gIH0pO1xuXG4gICQoJ2JvZHknKS5vbignY2xpY2snLCAnLmJ1dHRvbicsIGZ1bmN0aW9uKCkge1xuICBcdC8vIGUucHJldmVudERlZmF1bHQoKTtcbiAgXHRsZXQgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaWQnKTtcbiAgXHRpZiAoIG1vZGFsICkge1xuICBcdFx0Z2xvYi5Qb3B1cE1vZHVsZS5vcGVuUG9wdXAobW9kYWwpO1xuICBcdH1cbiAgfSk7XG5cbiAgLy8gLS0tLS0tLS0tQWNjb3JkaW9uIEJsb2Nrcy0tLS0tLS1cblx0LyokKCdhY2NvcmRpb25CbG9ja1NlbGVjdG9yJykub24oJ2NsaWNrJywgJy5idXR0b25TZWxlY3RvcicsIGZ1bmN0aW9uKGUpIHtcblx0XHQvLyBjb25zb2xlLnRpbWUoJ2NsaWNrIGFjY29yZGlvbiB3b3JraW5nIHRpbWUnKTtcblxuXHRcdGlmIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggPCA5OTIpIHtcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRsZXQgc3VibWVudUJsb2NrO1xuXHRcdFx0bGV0IGJ1dHRvbiA9IHRoaXM7XG5cblx0XHRcdHRoaXMuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaWRlYmFyT3BlbkJ1dHRvbicpID8gXG5cdFx0XHRcdHN1Ym1lbnVCbG9jayA9IHRoaXMucGFyZW50RWxlbWVudC5uZXh0RWxlbWVudFNpYmxpbmcgOiBcblx0XHRcdFx0c3VibWVudUJsb2NrID0gdGhpcy5uZXh0RWxlbWVudFNpYmxpbmc7XG5cblx0XHQvLyBsZXQgc2libGluZ3NCbG9ja3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjcHVibGljSW5mb1BhZ2UgYXJ0aWNsZS5wdWJsaWNJbmZvLWJsb2NrIC50aXRsZUJsb2NrICsgLmhpZGRlbkNvbnRlbnQnKTtcblxuXHRcdFx0Z2xvYkZ1bmMudG9nZ2xlQnV0dG9uQ29udGVudChidXR0b24pO1xuXHRcdFx0Z2xvYi5BY2NvcmRpb25Nb2R1bGUudG9nZ2xlQ29udGVudChcIndpdGhvdXRTaWJsaW5nc1wiLCBidXR0b24sIHN1Ym1lbnVCbG9jayApO1xuXHRcdFx0Ly8gQWNjb3JkaW9uTW9kdWxlLnRvZ2dsZUNvbnRlbnQoXCJ3aXRoU2libGluZ3NcIiwgYnV0dG9uLCBzdWJtZW51QmxvY2ssIHNpYmxpbmdzQmxvY2tzICk7XHRcdFx0XHRcblxuXHRcdH1cblx0XHQvLyBjb25zb2xlLnRpbWVFbmQoJ2NsaWNrIGFjY29yZGlvbiB3b3JraW5nIHRpbWUnKTtcblx0fSkqL1xuXG4gIC8vIC0tLS0tLS0tLVRleHQgTGltaXQtLS0tLS0tXG5cdC8qbGV0IHRleHRCbG9ja3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2VsZWN0b3InKTtcblx0dGV4dEJsb2Nrcy5sZW5ndGggPyBUZXh0TGltaXRNb2R1bGUuc2xpY2VUZXh0KHRleHRCbG9ja3MsIDE4MCkgOiBudWxsOyovXG5cdCQoXCIuZGVzY3JpcHRpb24gLmVsbGlwc2lzXCIpLmRvdGRvdGRvdCh7XHRoZWlnaHQ6IDgwLFx0dHJ1bmNhdGU6IFwid29yZFwiLFx0d2F0Y2g6IHRydWV9KTtcblx0JChcIi50aXRsZS5lbGxpcHNpc1wiKS5kb3Rkb3Rkb3Qoe1x0aGVpZ2h0OiA4NSxcdHRydW5jYXRlOiBcIndvcmRcIixcdHdhdGNoOiB0cnVlfSk7XG5cdFxuXG5cdC8vIC0tLS0tLS0tLS1TY3JvbGwtdG8gU2VjdGlvbi0tLS0tLS0tLS0tLS0tLVxuXHRcblx0LyokKCdib2R5Jykub24oJ2NsaWNrJywgJ2FydGljbGUuc3RvcnktaXRlbScsIGZ1bmN0aW9uKCkge1xuXHRcdFxuXHRcdCQoJ2h0bWwsIGJvZHknKS5hbmltYXRlKHtcblx0XHRcdHNjcm9sbFRvcDogJChcIiNcIiArICQodGhpcykuYXR0cignZGF0YS1zdG9yeS1pZCcpICkub2Zmc2V0KCkudG9wXG5cdFx0fSwgNTAwKTtcblx0fSkqL1xuXG5cdC8vIC0tLS0tLS0tLS0gU3RpY2t5IGJsb2NrLS0tLS0tLS0tLS0tLS0tXG5cdC8qdmFyIHN0aWNreUFzaWRlQmxvY2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdhc2lkZS5zdGlja3knKTtcblxuXHRpZiAoIHN0aWNreUFzaWRlQmxvY2sgJiYgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoID4gOTkxICkge1xuXHRcdHZhciB0YXJnZXRTdGlja0Jsb2NrID0gc3RpY2t5QXNpZGVCbG9jay5maXJzdEVsZW1lbnRDaGlsZDtcblx0XHRsZXQgcmVsYXRpdmVCbG9jayA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHN0aWNreUFzaWRlQmxvY2suZGF0YXNldC5zdGlja1RvKVxuXG5cdFx0Z2xvYi5TdGlja3lCbG9ja01vZHVsZS50b1N0aWNrKHRhcmdldFN0aWNrQmxvY2ssIHJlbGF0aXZlQmxvY2spO1x0XHRcblx0fSovXG5cblx0Ly8gLS0tLS0tLS0tQ2xlYW4gZW1wdHkgVGFncy0tLS0tXG5cdHZhciB0ZXh0QmxvY2tzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmRlc2NyaXB0aW9uID4gcCcpO1xuXG5cdGlmICh0ZXh0QmxvY2tzLmxlbmd0aCkge1xuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgdGV4dEJsb2Nrcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dGV4dEJsb2Nrc1tpXS5pbm5lckhUTUwgPyBudWxsIDogdGV4dEJsb2Nrc1tpXS5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKHRleHRCbG9ja3NbaV0pO1xuXHRcdH1cblx0fVxuXG5cdC8vIC0tLS0tLS1TZWxlY3QtLS0tLS0tLS0tXG5cdC8qJChcIi5jaG9zZW4td3JhcHBlciBzZWxlY3RcIikuY2hvc2VuKHtcblx0ICBkaXNhYmxlX3NlYXJjaF90aHJlc2hvbGQ6IDgsXG5cdCAgbm9fcmVzdWx0c190ZXh0OiBcItCd0LjRh9C10LPQviDQvdC1INC90LDQudC00LXQvdC+IVwiLFxuXHQgIHdpZHRoOiBcIjEwMCVcIlxuXHR9KTsqL1xuXG5cblxuXHQvLyA9PT09PT09PT09PUluaXRpYWxpemF0aW9ucz09PT09PT09PT09PT1cblxuXHQvLyBBbmltYXRlQm9yZGVyKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5hbmltYXRlZC1ib3JkZXItYmxvY2sgc3ZnJyksIHtcblx0Ly8gXHRib3JkZXJXaWR0aDogMyxcblx0Ly8gXHRzaGFkZWRTZWN0aW9uOiAxMDAsXG5cdC8vIFx0dHJhbnNwYXJlbnRTZWN0aW9uOiAyNSxcblx0Ly8gXHRyZXZlcnNlOiBmYWxzZSxcblx0Ly8gXHRyYWRpdXM6IHRydWUgXG5cdC8vIH0pXG5cdC8vIHByZXZBcnJvdzogJCgnLnByZXYnKSxcblx0Ly8gbmV4dEFycm93OiAkKCcubmV4dCcpLFxuXHRcblx0JCgnLnNsaWRlJykuc2xpY2soe1xuXHRcdGRvdHM6IHRydWUsXG5cdFx0aW5maW5pdGU6IHRydWUsXG5cdFx0c3BlZWQ6IDUwMCxcblx0XHRmYWRlOiB0cnVlLFxuXHRcdGNzc0Vhc2U6ICdsaW5lYXInLFxuXHRcdG5leHRBcnJvdzokKCcubmV4dCcpLFxuICAgICAgICBwcmV2QXJyb3c6JCgnLnByZXYnKSwgXG5cdCAgfSk7XG5cblx0ICAkKFwiLnNsaWRlXCIpLnNsaWNrKHtcbiAgICAgICAgbmV4dEFycm93OiAnPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJzbGljay1uZXh0XCI+cHJldjwvYnV0dG9uPicsXG4gICAgICAgIHByZXZBcnJvdzogJzxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5XCI+bmV4dDwvYnV0dG9uPidcblx0fSk7XG5cdFxuXHQkKCcuZXJ0Jykuc2xpY2soe1xuXHRcdGluZmluaXRlOiB0cnVlLFxuXHRcdHNsaWRlc1RvU2hvdzogMyxcblx0XHRzbGlkZXNUb1Njcm9sbDogM1xuXHQgIH0pO1xuXG59KTtcblxuXG53aW5kb3cub25sb2FkID0gZnVuY3Rpb24oKSB7XG5cdGNvbnNvbGUubG9nKCd3aW5kb3cgbG9hZCcpXG5cdC8vICQoJyNwYWdlLXByZWxvYWRlcicpLmZhZGVPdXQoJ3Nsb3cnKTtcblxuXHQvLyBnbG9iLkxhenlMb2FkTW9kdWxlLmluaXRMYXp5KCdsYXp5QmxvY2snKVxufVxuIl19
